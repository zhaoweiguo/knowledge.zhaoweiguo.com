乒乓操作
########

:keyword: 嵌入式


输入输出缓存电路的三种一般形式
==============================


* 双口 ram 结构：双口 RAM 是在一个 SRAM 存储器上具有两套完全独立的数据线、地址线、读写控制线、并允许两个独立的系统同时对该存储器进行随机访问。
* FIFO 结构：FIFO（First In First Out）是一种先进先出的数据缓存器，可以进行双端操作，但是数据必须先进先出，不能进行随机性的访问。
* 乒乓 ram 结构：这种结构是将输入数据流通过输入数据选择单元等时地将数据流分配到两个 ram 缓冲区。通过两个 ram 读和写的切换，来实现数据的流水式传输。

从容量大小来看，双口 RAM 比 FIFO 要大一些，但总的来说，这两种缓冲结构的存储容量还是相对较小，对高速图像处理系统而言，还不是特别适合。

.. note:: 乒乓缓存结构实际上相当于一个双口 RAM，但它与普通的双口 RAM 又有所不同。普通双口 RAM 是单个存储体构成的 IC，乒乓 ram 结构则由包含两个相互独立存储体的多片 IC 构成，从而使其在结构、速度、容量等方面具有更大的灵活性；若双口在访问同一地址时，普通双口 SAM 指向的必定是存储体内的同一存储单元，而乒乓 ram 结构则分别指向属于 SRAM1 和 SRAM2 的两个不同的存储单元，更易操作。乒乓缓存结构的上述特点决定了可以相对较便宜的高速大容量 SRAM、外围逻辑器件构成比双口 RAM 以及高速 FIFO 更适合视频处理的系统所需要的缓冲存储器。

乒乓 ram 控制原理
=================

.. figure:: https://img.zhaoweiguo.com/uPic/2022/08/TKWxvM.jpg

   "乒乓操作" 是一个常用的数据流控制处理技巧。输入数据流通过输入数据选择单元将数据流等时分配到两个数据缓冲区，数据缓冲模块一般为 ram。在第一个缓冲周期，将输入的数据流缓存到数据缓冲模块 ram A；在第 2 个缓冲周期，通过输入数据选择单元的切换，将输入的数据流缓存到数据缓冲模块 ram B，同时将 ram A 缓存的第 1 个周期数据传给输出数据选择单元。在第 3 个缓冲周期通过输入数据选择单元的再次切换，将输入的数据流缓存到 ram A 同时将 ram B 缓存的第 2 个周期的数据传给输出数据选择单元。如此循环。（正如打乒乓一样，数据只在球拍上停留短暂的时间，随即就将数据‘’拍‘’出去）

.. note:: 乒乓操作的最大特点是通过 “输入数据选择单元” 和 “输出数据选择单元” 按节拍、相互配合的切换，将经过缓冲的数据流没有停顿地送到 “数据流运算处理模块” 进行运算与处理。把乒乓操作模块当做一个整体，站在这个模块的两端看数据，输入数据流和输出数据流都是连续不断的，没有任何停顿，因此非常适合对数据流进行流水线式处理。所以乒乓操作常常应用于流水线式算法，完成数据的无缝缓冲与处理。









参考
====


* 乒乓操作原理简介与设计: https://blog.csdn.net/weixin_49495368/article/details/110628262






