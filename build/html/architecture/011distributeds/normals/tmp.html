

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>


<!-- start added 2025-04-14   增加对markdown中公式的支持 -->
<script>
window.MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true
    },
    options: {
        ignoreHtmlClass: "tex2jax_ignore|mathjax_ignore",
        processHtmlClass: "tex2jax_process|mathjax_process|math|output_area"
    }
};
</script>
<script defer="defer" src="https://fastly.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- end added 2025-04-14   增加对markdown中公式的支持 -->


<!-- start added 2025-08-06   增加对mermaid图的支持 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        flowchart: { useMaxWidth: true }
    });
});
</script>
<!--  end added 2025-08-06   增加对mermaid图的支持 -->




  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>临时 &mdash; 新溪-gordon V2025.10 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="并发相关理论" href="../theory.html" />
    <link rel="prev" title="并发" href="concept.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>
  <script src="../../_static/js/jquery.min.js"></script>


<!-- 评论插件 gittalk start -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> -->
<!-- 评论插件 gittalk end -->


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> 新溪-gordon
          

          
          </a>

          
            
            
              <div class="version">
                V2025.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">关键知识</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../010architecture.html">010架构设计</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/normals/%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1.html">互联网业务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/normals/tmp.html">临时</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/normals/other.html">其他架构设计</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/cqrs.html">CQRS </a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/crud.html">CRUD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/ddd.html">领域驱动设计</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/api.html">api设计</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/SSO.html">单点登录</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/event_driver.html">事件驱动架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/network_agent.html">网络代理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/message_bus.html">消息总线</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/mvc_mvp_mvvm.html">MVC MVP MVVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/normals/others/other.html">其他</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/history.html">架构的历史</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/01origin_distributed_sys.html">原始分布式时代</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/02monolithic_sys.html">单体系统时代</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/03soa_sys.html">SOA架构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/04microService.html">微服务架构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/04microServices/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/04microServices/9feature.html">微服务的九个核心的业务与技术特征</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/04microServices/ServiceMesh.html">ServiceMesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/04microServices/collect.html">微服务架构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/05cloudnative.html">云原生时代——后微服务时代</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/05cloudnatives/collect1.html">云原生</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/05cloudnatives/collect2.html">收集2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/05cloudnatives/12Factor.html">云原生应用的12要素</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/05cloudnatives/distribute_architecture.html">从分布式架构到云原生架构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/historys/06serverless.html">无服务时代</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/historys/06serverless/collect1.html">Serverless</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/architecture_design.html">软件架构设计</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_designs/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_designs/history_design.html">架构设计的历史</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_designs/purpose.html">架构设计目的</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/1performance.html">复杂度来源-高性能</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/2availability.html">复杂度来源-高可用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/3expandability.html">复杂度来源-可扩展性</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/4lowcost.html">复杂度来源-低成本</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/5security.html">复杂度来源-安全</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/6scalability.html">复杂度来源-规模</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/purposes/7other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_designs/principle.html">架构设计原则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_designs/process.html">架构设计流程</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/process/1recognize.html">识别复杂度</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/process/2alternative.html">设计备选方案</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/process/3assess.html">评估&amp;选择备选方案</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_designs/process/4detailed.html">详细方案设计</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/architecture_pattern.html">架构模式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_patterns/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_patterns/performance.html">高性能架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/1read-write-seperate.html">读写分离</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/2split-db-table.html">分库分表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/3NoSQL.html">高性能 NoSQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/4cache.html">高性能缓存架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/5PPC-TPC.html">单服务器高性能模式: PPC&amp;TPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/6Reactor-Proactor.html">单服务器高性能模式: Reactor&amp;Proactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/performances/7slb.html">高性能负载均衡: 分类&amp;架构&amp;算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_patterns/availability.html">高可用架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/1CAP.html">CAP理论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/2FMEA.html">FMEA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/3storage.html">存储高可用架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/4computing.html">计算高可用架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/5different-live.html">异地多活</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/availabilitys/6api-failure.html">接口级故障&amp;应对</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/architecture_patterns/expandability.html">可扩展架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/1basic-ideas-and-pattern.html">可扩展架构的基本思想和模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/2hierarchical.html">传统可扩展架构-分层架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/3soa.html">传统可扩展架构-SOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/4microservice.html">微服务架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/architecture_patterns/expandabilitys/5microkernel.html">微内核架构</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/communication_pattern.html">通信模式communication patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/communication_patterns/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/communication_patterns/SAP.html">SAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/communication_patterns/theory.html">理论</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/evolution.html">架构演进/重构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/evolutions/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/evolutions/be-microservice.html">对现有系统做微服务化改造</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/evolutions/evolution-graph.html">演进架构图</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/graph.html">架构图</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/graphs/normal.html">常用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/graphs/normals/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/graphs/normals/color.html">颜色</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../010architectures/graphs/normals/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/graphs/business.html">业务架构图</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/graphs/c4-model.html">软件架构——C4模型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/graphs/%E6%9E%B6%E6%9E%84%E5%9B%BE%E6%8A%80%E5%B7%A7.html">架构图技巧</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../010architectures/EA.html">EA企业级架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/EAs/TOGAF.html">TOGAF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../010architectures/EAs/Zachman.html">Zachman扎克曼框架</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../011distributed.html">011分布式系统</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../normal.html">常用</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="normal.html">分布式系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="concept.html">并发</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">临时</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory.html">并发相关理论</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theorys/CAP.html">并发相关-CAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/PACELC.html">PACELC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/FLP.html">并发相关-FLP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/DLS.html">DLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/CSP.html">并发模型-CSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/CAS.html">CAS 机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/Actor.html">并发模型-Actor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/Gossip.html">Gossip协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/BASE.html">BASE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/ACID.html">ACID原则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/UUID.html">UUID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theorys/consistent_hash.html">一致性hash</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../transaction.html">事务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../transactions/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transactions/local.html">本地事务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transactions/global.html">全局事务(Global Transactions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transactions/share.html">共享事务(Share Transactions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transactions/distribute.html">分布式事务</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../transactions/distributes/reliable_event_queue.html">可靠事件队列</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transactions/distributes/SAGA.html">SAGA 事务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transactions/distributes/TCC.html">TCC 事务</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../consensus.html">分布式共识</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../consensus/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../consensus/Paxos.html">Paxos算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../consensus/zab.html">zab协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../consensus/Raft.html">The Raft Consensus Algorithm </a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../012SoftEngineering.html">012软件工程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/methodology.html">编程方法论</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/code-quality.html">代码质量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/complexity.html">复杂度</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/Programming-Spec.html">编程规范</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/Refactor.html">重构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/5W2H.html">5W2H 分析法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html">重构手段-单元测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id3">定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id4">作用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id5">如何编写单元测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id6">为何难落地执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#anti-patterns">影响可测试性的 Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-decoupling.html">重构手段-解耦</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/code-standard.html">改善代码质量的编程规范</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/document.html">设计文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../021microservice.html">021微服务架构</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/discovery.html">服务注册&amp;发现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/api_gateway.html">API网关</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/contract.html">对比</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/tmp.html">临时</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../022middle-platform.html">022中台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../031dataanalysis.html">031数据分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/data.html">数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/tmp.html">临时</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../041governance.html">041服务治理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../041governances/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/technical-debt.html">技术债</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/anti-fragile.html">反脆弱</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/code-review.html">Code Review</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../041governances/service_protection.html">服务保护</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../051compiler.html">051编译原理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/tool.html">工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80.html">汇编语言</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90.html">词法分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90.html">词法分析, 语法分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90.html">语义分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/LLVM.html">LLVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/IR.html">编译期后端技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../052composition-principle.html">052 计算机组成原理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/CPU%20%E5%8E%82%E5%95%86.html">CPU 厂商</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/CPU%20Arch.html">CPU 架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/Arm.html">Arm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/X86.html">X86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/API.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../053os.html">053操作系统</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../053os/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../053os/signal.html">signal信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../053os/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../054algorithm.html">054算法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/algorithm.html">经典算法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/nlp.html">NLP相关算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/encrypt.html">加密相关算法</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/tree.html">树结构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/b-tree.html">b-树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/b%2Btree.html">b+树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/lsm_tree.html">LSM树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/balanced_binary_tree.html">平衡二叉树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/red_black_tree.html">红黑树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/trie-tree.html">Trie 树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/merkle-tree.html">Merkle 树</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/example.html">实例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/website.html">网站</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/iq.html">智力题</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/graph_theory.html">图论</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/other.html">其他算法</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">新溪-gordon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../011distributed.html">011分布式系统</a> &raquo;</li>
        
          <li><a href="../normal.html">常用</a> &raquo;</li>
        
      <li>临时</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/011distributeds/normals/tmp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            <nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
              <h4 id="local-table-of-contents-title">On This Page</h4>
              <ul>
<li><a class="reference internal" href="#">临时</a><ul>
<li><a class="reference internal" href="#id3">分布式系统优缺点</a></li>
<li><a class="reference internal" href="#id4">分布式系统的发展</a></li>
<li><a class="reference internal" href="#id5">分布式系统技术栈</a><ul>
<li><a class="reference internal" href="#id6">提高架构的性能</a></li>
<li><a class="reference internal" href="#id7">提高架构的稳定性</a></li>
<li><a class="reference internal" href="#id8">分布式系统的关键技术</a></li>
<li><a class="reference internal" href="#id9">分布式系统的”纲”</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">关键技术: 全栈监控</a><ul>
<li><a class="reference internal" href="#id11">好的监控系统</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">关键技术: 服务调度</a><ul>
<li><a class="reference internal" href="#id13">服务治理</a><ul>
<li><a class="reference internal" href="#id14">1. 服务关键程度</a></li>
<li><a class="reference internal" href="#id15">2. 服务依赖关系</a></li>
<li><a class="reference internal" href="#id16">3. 服务发现</a></li>
<li><a class="reference internal" href="#id17">4. 整个架构的版本管理</a></li>
<li><a class="reference internal" href="#id18">5. 服务应用生命周期全管理</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id19">资源 / 服务调度</a><ul>
<li><a class="reference internal" href="#id20">1. 服务状态的维持和拟合</a></li>
<li><a class="reference internal" href="#id21">2. 服务的弹性伸缩和故障迁移</a></li>
<li><a class="reference internal" href="#id22">5. 服务编排</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id23">流量与数据调度</a><ul>
<li><a class="reference internal" href="#id24">流量调度的主要功能</a></li>
<li><a class="reference internal" href="#id25">流量调度的关键技术</a></li>
<li><a class="reference internal" href="#id26">分布式事务一致性的问题</a></li>
<li><a class="reference internal" href="#id27">数据结点的分布式方案</a></li>
</ul>
</li>
<li><a class="reference internal" href="#paas">PaaS平台的本质</a></li>
</ul>
</li>
</ul>

            </nav>
  <table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
<section id="id2">
<h1>临时<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h1>
<section id="id3">
<h2>分布式系统优缺点<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<p>使用分布式系统主要有两方面原因:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 增大系统容量
  我们的业务量越来越大，而要能应对越来越大的业务量，
  一台机器的性能已经无法满足了，我们需要多台机器才能应对大规模的应用场景。
  所以，我们需要垂直或是水平拆分业务系统，让其变成一个分布式的架构。
2. 加强系统可用
  我们的业务越来越关键，需要提高整个系统架构的可用性，这就意味着架构中不能存在单点故障。
  这样，整个系统不会因为一台机器出故障而导致整体不可用。
  所以，需要通过分布式架构来冗余系统以消除单点故障，从而提高系统的可用性。
</pre></div>
</div>
<p>分布式系统还有一些优势，比如:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 因为模块化，所以系统模块重用度更高
2. 因为软件服务模块被拆分，开发和发布速度可以并行而变得更快
3. 系统扩展性更高
4. 团队协作流程也会得到改善
5. ……
</pre></div>
</div>
<figure class="align-default" id="id29">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/compare-monolithic1.png" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/compare-monolithic1.png" />
<figcaption>
<p><span class="caption-text">单体应用和分布式架构的优缺点</span><a class="headerlink" href="#id29" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<p>分布式架构的问题:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 架构设计变得复杂（尤其是其中的分布式事务）
2. 部署单个服务会比较快，但是如果一次部署需要多个服务，流程会变得复杂
3. 系统的吞吐量会变大，但是响应时间会变长
4. 运维复杂度会因为服务变多而变得很复杂
5. 架构复杂导致学习曲线变大
6. 测试和查错的复杂度增大
7. 技术多元化，这会带来维护和运维的复杂度
8. 管理分布式系统中的服务和调度变得困难和复杂
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>分布式系统架构的难点在于系统设计，以及管理和运维。</p>
</div>
</section>
<section id="id4">
<h2>分布式系统的发展<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h2>
<figure class="align-default" id="id30">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/compare-soa.webp" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/compare-soa.webp" />
<figcaption>
<p><span class="caption-text">SOA 架构的演化图</span><a class="headerlink" href="#id30" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
</section>
<section id="id5">
<h2>分布式系统技术栈<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h2>
<p>构建分布式系统的目的是增加系统容量，提高系统的可用性，转换成技术方面，也就是完成下面两件事:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 大流量处理
  通过集群技术把大规模并发请求的负载分散到不同的机器上。
2. 关键业务保护
  提高后台服务的可用性，把故障隔离起来阻止多米诺骨牌效应（雪崩效应）。
  如果流量过大，需要对业务降级，以保护关键业务流转。

即:
  1. 提高整体架构的吞吐量，服务更多的并发和流量
  2. 为了提高系统的稳定性，让系统的可用性更高
</pre></div>
</div>
<section id="id6">
<h3>提高架构的性能<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h3>
<figure class="align-default" id="id31">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/tune-tech-method-performance.webp" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/tune-tech-method-performance.webp" />
<figcaption>
<p><span class="caption-text">提高系统性能的常用技术</span><a class="headerlink" href="#id31" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
</section>
<section id="id7">
<h3>提高架构的稳定性<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h3>
<figure class="align-default" id="id32">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/tune-tech-method-stability.webp" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/tune-tech-method-stability.webp" />
<figcaption>
<p><span class="caption-text">提高系统系统稳定性的一些常用技术</span><a class="headerlink" href="#id32" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
</section>
<section id="id8">
<h3>分布式系统的关键技术<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 服务治理。
    服务拆分、服务调用、服务发现、服务依赖、服务的关键度定义……
    服务治理的最大意义是需要把服务间的依赖关系、服务调用链，以及关键的服务给梳理出来，
      并对这些服务进行性能和可用性方面的管理。
2. 架构软件管理。
    服务之间有依赖，而且有兼容性问题，
    所以，整体服务所形成的架构需要有架构版本管理、整体架构的生命周期管理，
      以及对服务的编排、聚合、事务处理等服务调度功能。
3. DevOps。
    分布式系统可以更为快速地更新服务，但是对于服务的测试和部署都会是挑战。
    所以，还需要 DevOps 的全流程，其中包括环境构建、持续集成、持续部署等。
4. 自动化运维。
    有 DevOps 后，就可以对服务进行自动伸缩、故障迁移、配置管理、状态管理等一系列的自动化运维技术了。
5. 资源调度管理。
    应用层的自动化运维需要基础层的调度支持，
    也就是云计算 IaaS 层的计算、存储、网络等资源调度、隔离和管理。
6. 整体架构监控。
    如果没有一个好的监控系统，那么自动化运维和资源调度管理只可能成为一个泡影，
    因为监控系统是你的眼睛。没有眼睛，没有数据，就无法进行高效的运维。
    所以说，监控是非常重要的部分。
    这里的监控需要对三层系统（应用层、中间件层、基础层）进行监控。
7. 流量控制。
    包括负载均衡、服务路由、熔断、降级、限流等和流量相关的调度
    还包括灰度发布之类的功能也在这里。
</pre></div>
</div>
</section>
<section id="id9">
<h3>分布式系统的”纲”<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h3>
<p>分布式系统有五个关键技术:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 全栈系统监控
2. 服务 / 资源调度
3. 流量调度
4. 状态 / 数据调度
5. 开发和运维的自动化

开发和运维的自动化，是需要把前四项都做到了，才有可能实现的
</pre></div>
</div>
<figure class="align-default" id="id33">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech0.png" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech0.png" />
<figcaption>
<p><span class="caption-text">构建分布式系统最最核心的东西</span><a class="headerlink" href="#id33" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id10">
<h2>关键技术: 全栈监控<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h2>
<figure class="align-default" id="id34">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech1-monitor1.png" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech1-monitor1.png" />
<figcaption>
<p><span class="caption-text">全栈监控</span><a class="headerlink" href="#id34" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<p>监控的标准化:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 日志数据结构化；
2. 监控数据格式标准化；
3. 统一的监控平台；
4. 统一的日志分析。
</pre></div>
</div>
<section id="id11">
<h3>好的监控系统<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h3>
<p>监控系统都做不好有两个很大的问题:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 监控数据是隔离开来的。
    因为公司分工的问题，开发、应用运维、系统运维，各管各的，
    所以很多公司的监控系统之间都有一道墙，完全串不起来。
2. 监控的数据项太多。
    有些公司的运维团队把监控的数据项多做为一个亮点到处讲，比如监控指标达到 5 万多个。
    老实说，这太丢人了。
    因为信息太多等于没有信息，抓不住重点的监控才会做成这个样子。
</pre></div>
</div>
<p>一个好的监控系统应该有以下几个特征:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 关注于整体应用的 SLA。
    主要从为用户服务的 API 来监控整个系统。
2. 关联指标聚合。
    把有关联的系统及其指标聚合展示。
    主要是三层系统数据：基础层、平台中间件层和应用层。
    最重要的是把服务和相关的中间件以及主机关联在一起
      无论运行在哪里，我们都需要把服务的具体实例和主机关联在一起，
      否则，对于一个分布式系统来说，定位问题犹如大海捞针。
3. 快速故障定位。
  对于现有的系统来说，故障总是会发生的，而且还会频繁发生。
  故障发生不可怕，可怕的是故障的恢复时间过长。
  所以，快速地定位故障就相当关键。
  快速定位问题需要对整个分布式系统做一个用户请求跟踪的 trace 监控，
    需要监控到所有的请求在分布式系统中的调用链，这个事最好是做成没有侵入性的。
</pre></div>
</div>
<p>一个好的监控系统主要是为以下两个场景所设计的:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. “体检”
  a. 容量管理。
    提供一个全局的系统运行时数据的展示，可以让工程师团队知道是否需要增加机器或者其它资源。
  b. 性能管理。
    可以通过查看大盘，找到系统瓶颈，并有针对性地优化系统和相应代码。
2. “急诊”
  a. 定位问题。
    可以快速地暴露并找到问题的发生点，帮助技术人员诊断问题。
  b. 性能分析。
    当出现非预期的流量提升时，可以快速地找到系统的瓶颈，并帮助开发人员深入代码。
</pre></div>
</div>
<p>一个好的监控系统应该实现的功能:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 服务调用链跟踪。
  这个事情的最佳实践是 Google Dapper 系统
2. 服务调用时长分布
  有助于我们知道最耗时的服务是什么
3. 服务的 TOP N 视图
  有三种排名的方法:
  a. 按调用量排名
  b. 按请求最耗时排名
  c. 按热点排名（一个时间段内的请求次数的响应时间和）
4. 数据库操作关联
  执行数据库操作的执行时间
5. 服务资源跟踪
  把服务运行的机器节点上的数据（如 CPU、MEM、I/O、DISK、NETWORK）关联起来
</pre></div>
</div>
<p>现象都是某个服务过慢:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 如果是因为 CPU 使用过多，我们就可以做弹性伸缩。
2. 如果是因为 MySQL 出现慢查询，就不能在应用层上做弹性伸缩，只能做流量限制，或降级操作
</pre></div>
</div>
<figure class="align-default" id="id35">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech1-monitor2.webp" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/keytech1-monitor2.webp" />
<figcaption>
<p><span class="caption-text">最重要的事就是把监控系统做好。在把数据收集好的同时，更重要的是把数据关联好。这样，我们才可能很快地定位故障，进而才能进行自动化调度。</span><a class="headerlink" href="#id35" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id12">
<h2>关键技术: 服务调度<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>服务治理可能混合了流量调度等其它内容。</p>
</div>
<section id="id13">
<h3>服务治理<a class="headerlink" href="#id13" title="此标题的永久链接">¶</a></h3>
<p>服务治理上的关键技术:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">服务关键程度</span>
<span class="mf">2.</span> <span class="n">服务依赖关系</span>
<span class="mf">3.</span> <span class="n">服务发现</span>
<span class="mf">4.</span> <span class="n">整个架构的版本管理</span>
<span class="mf">5.</span> <span class="n">服务应用生命周期全管理</span>
</pre></div>
</div>
<section id="id14">
<h4>1. 服务关键程度<a class="headerlink" href="#id14" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>这不是使用技术可以完成的，
它需要细致地管理对业务的理解，才能定义出架构中各个服务的重要程度。
</pre></div>
</div>
</section>
<section id="id15">
<h4>2. 服务依赖关系<a class="headerlink" href="#id15" title="此标题的永久链接">¶</a></h4>
<p>依赖关系就像“铁锁连环”一样，一个服务的问题很容易出现一条链上的问题。</p>
<p>因此:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>a. 传统的 SOA 希望通过 ESB 来解决服务间的依赖关系
b. 微服务希望服务间是没有依赖的，而让上层或是前端业务来整合这些个后台服务
</pre></div>
</div>
<p>真正做到服务无依赖，我认为还是比较有困难的:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>我们只能是降低服务依赖的深度和广度，从而让管理更为简单和简洁
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>微服务是服务依赖最优解的上限，而服务依赖的下限是千万不要有依赖环。</p>
</div>
<p>解决服务依赖环的方案:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>依赖倒置的设计模式。
在分布式架构上，你可以使用一个第三方的服务来解决这个事。
比如:
1. 通过订阅或发布消息到一个消息中间件，
2. 把其中的依赖关系抽到一个第三方的服务中，由这个三方服务来调用这些原本循环依赖的服务
</pre></div>
</div>
<p>服务的依赖关系发现:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">全链路追踪</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>梳理完服务的重要程度和服务依赖关系之后，我们就相当于知道了整个架构的全局。就好像我们得到了一张城市地图，在这张地图上可以看到城市的关键设施，以及城市的主干道。再加上相关的监控，我们就可以看到城市各条道路上的工作和拥堵情况。这对于我们整个分布式架构是非常非常关键的。在解决一些高并发或是架构问题的时候，有这么一张地图非常方便。</p>
</div>
</section>
<section id="id16">
<h4>3. 服务发现<a class="headerlink" href="#id16" title="此标题的永久链接">¶</a></h4>
<p>“架构城市”是非常动态的，有的服务会新加进来，有的会离开，有的会增加更多的实例，有的会减少，有的服务在维护过程中（发布、伸缩等），所以我们需要有一个服务注册中心，来知道这么几个事:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 整个架构中有多少种服务
2. 这些服务的版本是什么样的
3. 每个服务的实例数有多少个，它们的状态是什么样的
4. 每个服务的状态是什么样的
    部署中，运行中，故障中，升级中，回滚中，伸缩中，下线中
</pre></div>
</div>
</section>
<section id="id17">
<h4>4. 整个架构的版本管理<a class="headerlink" href="#id17" title="此标题的永久链接">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除了各个项目的版本管理之外，还需要在上面再盖一层版本管理。如：Linux 分发包中各个软件的版本上会再盖一层版本控制。毕竟，这些分发包也是有版本依赖的，这样可以解决各个包的版本兼容性问题。</p>
</div>
<p>一个架构的 manifest，一个服务清单，这个服务清单定义了所有服务的版本运行环境，其中包括但不限于:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 服务的软件版本
2. 服务的运行环境——环境变量、CPU、内存、可以运行的结点、文件系统等
3. 服务运行的最大最小实例数
</pre></div>
</div>
</section>
<section id="id18">
<h4>5. 服务应用生命周期全管理<a class="headerlink" href="#id18" title="此标题的永久链接">¶</a></h4>
<p>服务的生命周期通常会有以下几个状态:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Provision，代表在供应一个新的服务
2. Ready，表示启动成功了
3. Run，表示通过了服务健康检查
4. Update，表示在升级中
5. Rollback，表示在回滚中
6. Scale，表示正在伸缩中（可以有 Scale-in 和 Scale-out 两种）
7. Destroy，表示在销毁中
8. Failed，表示失败状态
</pre></div>
</div>
</section>
</section>
<section id="id19">
<h3>资源 / 服务调度<a class="headerlink" href="#id19" title="此标题的永久链接">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>服务和资源的调度有点像操作系统。操作系统一方面把用户进程在硬件资源上进行调度，另一方面提供进程间的通信方式，可以让不同的进程在一起协同工作。</p>
</div>
<p>一些关键技术:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">服务状态的维持和拟合</span>
<span class="mf">2.</span> <span class="n">服务的弹性伸缩和故障迁移</span>
<span class="mf">3.</span> <span class="n">作业和应用调度</span>
<span class="mf">4.</span> <span class="n">作业工作流编排</span>
<span class="mf">5.</span> <span class="n">服务编排</span>
</pre></div>
</div>
<section id="id20">
<h4>1. 服务状态的维持和拟合<a class="headerlink" href="#id20" title="此标题的永久链接">¶</a></h4>
<p>所谓服务状态不是服务中的数据状态，而是服务的运行状态:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>换句话说就是服务的 Status，而不是 State
也就是上述服务运行时生命周期中的状态:
  Provision，Ready，Run，Scale，Rollback，Update，Destroy，Failed
</pre></div>
</div>
<p>服务运行过程中，状态也是会有变化的，这样的变化有两种:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 一种是不预期的变化(服务状态维持)
    如，服务运行因为故障导致一些服务挂掉，或是别的什么原因出现了服务不健康的状态。
    而一个好的集群管理控制器应该能够强行维护服务的状态。
    在健康的实例数变少时，控制器会把不健康的服务给摘除，而又启动几个新的，强行维护健康的服务实例数。
2. 另外一种是预期的变化(服务状态拟合)
    如，我们需要发布新版本，需要伸缩，需要回滚。
    这时，集群管理控制器就应该把集群从现有状态迁移到另一个新的状态。
    这个过程并不是一蹴而就的，集群控制器需要一步一步地向集群发送若干控制命令。
</pre></div>
</div>
<p>当需要对集群进行 Scale 的时候，我们需要:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">先扩展出几个结点</span>
<span class="mf">2.</span> <span class="n">再部署服务</span>
<span class="mf">3.</span> <span class="n">然后启动服务</span>
<span class="mf">4.</span> <span class="n">再检查服务的健康情况</span>
<span class="mf">5.</span> <span class="n">最后把新扩展出来的服务实例加入服务发现中提供服务</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>服务状态“拟合”是指在发布新版本、伸缩、回滚时，从一个状态拟合到另一个状态，而且要穷尽所有的可能，玩命地不断地拟合，直到达到目的。</p>
</div>
</section>
<section id="id21">
<h4>2. 服务的弹性伸缩和故障迁移<a class="headerlink" href="#id21" title="此标题的永久链接">¶</a></h4>
<p>弹性伸缩包括:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">底层资源的伸缩</span>
<span class="mf">2.</span> <span class="n">服务的自动化部署</span>
<span class="mf">3.</span> <span class="n">服务的健康检查</span>
<span class="mf">4.</span> <span class="n">服务发现的注册</span>
<span class="mf">5.</span> <span class="n">服务流量的调度</span>
</pre></div>
</div>
<p>故障迁移有两种模式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 宠物模式，就是一定要救活，主要是对于 stateful 的服务
2. 奶牛模式，就是不救活了，重新生成一个实例


1. 服务的健康监控（这可能需要一个 APM 的监控）
2. 宠物模式，需要：服务的重新启动和服务的监控报警（如果重试恢复不成功，需要人工介入）
3. 奶牛模式，需要：服务的资源申请，服务的自动化部署，服务发现的注册，以及服务的流量调度
</pre></div>
</div>
</section>
<section id="id22">
<h4>5. 服务编排<a class="headerlink" href="#id22" title="此标题的永久链接">¶</a></h4>
<p>Choreography VS Orchestration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Orchestration
    一个服务像大脑一样来告诉大家应该怎么交互，就跟乐队的指挥一样
    参考《Service-oriented Design：A Multi-viewpoint Approach》
2. Choreography
    在各自完成专属自己的工作的基础上，互相协作，就跟芭蕾舞团的舞者一样
</pre></div>
</div>
</section>
</section>
</section>
<section id="id23">
<h2>流量与数据调度<a class="headerlink" href="#id23" title="此标题的永久链接">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>流量调度和服务治理区别：一方面，服务治理是内部系统的事，而流量调度可以是内部的，也可以是外部接入层的事。另一方面，服务治理是数据中心的事，而流量调度要做得好，应该是数据中心之外的事，也就是我们常说的边缘计算，是应该在类似于 CDN 上完成的事。所以，流量调度和服务治理是在不同层面上的，不应该混在一起，所以在系统架构上应该把它们分开。</p>
</div>
<section id="id24">
<h3>流量调度的主要功能<a class="headerlink" href="#id24" title="此标题的永久链接">¶</a></h3>
<p>流量调度系统的主要功能:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 依据系统运行的情况，自动地进行流量调度，在无需人工干预的情况下，提升整个系统的稳定性
2. 应对爆品等突发事件时，在弹性计算扩缩容的较长时间窗口内或底层资源消耗殆尽的情况下，保护系统平稳运行

本质还是为了提高系统架构的稳定性和高可用性
</pre></div>
</div>
<p>流量调度系统还可以完成以下几方面的事情:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 服务流控
    服务发现、服务路由、服务降级、服务熔断、服务保护等
2. 流量控制
    负载均衡、流量分配、流量控制、异地灾备（多活）等
3. 流量管理
    协议转换、请求校验、数据缓存、数据计算等
</pre></div>
</div>
</section>
<section id="id25">
<h3>流量调度的关键技术<a class="headerlink" href="#id25" title="此标题的永久链接">¶</a></h3>
<p>一个好的 API Gateway 需要具备以下的关键技术:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 高性能
    API Gateway 必须使用高性能的技术，所以，也就需要使用高性能的语言
2. 扛流量
    要能扛流量，就需要使用集群技术。
    集群技术的关键点是在集群内的各个结点中共享数据。
    这就需要使用像 Paxos、Raft、Gossip 这样的通讯协议。
    因为 Gateway 需要部署在广域网上，所以还需要集群的分组技术。
3. 业务逻辑
    API Gateway 需要有简单的业务逻辑
    所以，最好是像 AWS 的 Lambda 服务一样，可以让人注入不同语言的简单业务逻辑。
4. 服务化
    一个好的 API Gateway 需要能够通过 Admin API 来不停机地管理配置变更
    而不是通过一个.conf 文件来人肉地修改配置
</pre></div>
</div>
</section>
<section id="id26">
<h3>分布式事务一致性的问题<a class="headerlink" href="#id26" title="此标题的永久链接">¶</a></h3>
<p>数据副本是分布式系统解决数据丢失异常的唯一手段:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 要想让数据有高可用性，就得写多份数据
2. 写多份会引起数据一致性的问题
3. 数据一致性的问题又会引发性能问题
</pre></div>
</div>
<p>技术方案:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Master</span><span class="o">-</span><span class="n">Slave</span> <span class="n">方案</span>
<span class="mf">2.</span> <span class="n">Master</span><span class="o">-</span><span class="n">Master</span> <span class="n">方案</span>
<span class="mf">3.</span> <span class="n">两阶段和三阶段提交方案</span>
<span class="mf">4.</span> <span class="n">Paxos</span> <span class="n">方案</span>
</pre></div>
</div>
<p>在应用层上解决事务问题，只有“两阶段提交”这样的方式，而在数据层解决事务问题，Paxos 算法则是不二之选。</p>
</section>
<section id="id27">
<h3>数据结点的分布式方案<a class="headerlink" href="#id27" title="此标题的永久链接">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>真正完整解决数据 Scale 问题的应该还是数据结点自身。只有数据结点自身解决了这个问题，才能做到对上层业务层的透明，业务层可以像操作单机数据库一样来操作分布式数据库，这样才能做到整个分布式服务架构的调度。</p>
</div>
<p>对于一些需要文件存储的，则需要分布式文件系统的支持。试想，一个 Kafka 或 ZooKeeper 需要把它们的数据存储到文件系统上。（虽然 Kafka 和 ZooKeeper 是 HA 的，数据会在不同的结点中进行复制，但是我们也应该搬迁数据，这样有利用于新结点的快速启动。）</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>真正解决数据结点调度的方案应该是底层的数据结点。在它们上面做这个事才是真正有效和优雅的。</p>
</div>
</section>
</section>
<section id="paas">
<h2>PaaS平台的本质<a class="headerlink" href="#paas" title="此标题的永久链接">¶</a></h2>
<p>软件工程能力主要体现在:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 提高服务的 SLA
    a. 高可用的系统
    b. 自动化的运维
        因为故障是常态，如果没有自动化的故障恢复，就很难提高服务的 SLA
2. 能力和资源重用或复用
    a. 软件模块的重用(软件抽象的能力)
        软件抽象就是找出通用的软件模块或服务
    b. 软件运行环境和资源的重用(软件标准化的能力)
        软件标准化就是使用统一的软件通讯协议、统一的开发和运维管理方法
3. 过程的自动化
    a. 软件生产流水线
        CI/CD 的 DevOps 式的自动化
    b. 软件运维自动化
</pre></div>
</div>
<p>软件工程的三个本质:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">分布式多层的系统架构</span>
<span class="mf">2.</span> <span class="n">服务化的能力供应</span>
<span class="mf">3.</span> <span class="n">自动化的运维能力</span>
</pre></div>
</div>
<p>PaaS 跟传统中间件最大的差别:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 服务化是 PaaS 的本质
    软件模块重用，服务治理，对外提供能力是 PaaS 的本质
2. 分布式是 PaaS 的根本特性
    多租户隔离、高可用、服务编排是 PaaS 的基本特性
3. 自动化是 PaaS 的灵魂
    自动化部署安装运维，自动化伸缩调度是 PaaS 的关键
</pre></div>
</div>
<p>一个完整的 PaaS 平台会包括以下几部分:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. PaaS 调度层 – 主要是 PaaS 的自动化和分布式对于高可用高性能的管理
2. PaaS 能力服务层 – 主要是 PaaS 真正提供给用户的服务和能力
3. PaaS 的流量调度 – 主要是与流量调度相关的东西，包括对高并发的管理
4. PaaS 的运营管理 – 软件资源库、软件接入、认证和开放平台门户
5. PaaS 的运维管理 – 主要是 DevOps 相关的东西
</pre></div>
</div>
<figure class="align-default" id="id36">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/architecture1.webp" src="https://img.zhaoweiguo.com/knowledge/images/architectures/distributes/zuoertingfengs/architecture1.webp" />
<figcaption>
<p><span class="caption-text">PaaS 平台的总体架构</span><a class="headerlink" href="#id36" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>【极客】左耳听风-分布式架构: <a class="reference external" href="https://time.geekbang.org/column/intro/48">https://time.geekbang.org/column/intro/48</a></p></li>
</ul>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../theory.html" class="btn btn-neutral float-right" title="并发相关理论" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concept.html" class="btn btn-neutral" title="并发" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  <div id="gitalk-container"></div>
  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2025, 新溪-gordon.

    </p>
  </div>
  <div>备案号 <a href="http://www.beian.miit.gov.cn">京ICP备16018553号</a></div><div>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a></div>. 


</footer>

<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?042289284b8eb33866001347a3e0b129";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>     
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'V2025.10',
            LANGUAGE:'zh-CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });


      // var gitalk = new Gitalk({
      //         clientID: '565177626b5d46427009',
      //         clientSecret: 'b2a36e67e1d2a73e43667f46d571c2624f8e1026',
      //         repo: 'knowledge',
      //         owner: 'zhaoweiguo',
      //         admin: ['zhaoweiguo'],
      //         id: location.pathname,      // Ensure uniqueness and length less than 50
      //         distractionFreeMode: false  // Facebook-like distraction free mode
      //       })
      // gitalk.render('gitalk-container')

  </script>


<script type="text/javascript" src="../../_static/js/table-of-contents-sidebar.js"></script>
<!-- <script type="text/javascript" src="https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/table-of-contents-sidebar.js"></script> -->
<script type="text/javascript">
    window.onload = function(e){
        TableOfContents.init({
            basePath: "https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/",
            querySelector: "body" // or other css querySelector
        });
    }
</script> 

</body>
</html>