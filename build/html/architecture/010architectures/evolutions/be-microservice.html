

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>


<!-- start added 2025-04-14   增加对markdown中公式的支持 -->
<script>
window.MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true
    },
    options: {
        ignoreHtmlClass: "tex2jax_ignore|mathjax_ignore",
        processHtmlClass: "tex2jax_process|mathjax_process|math|output_area"
    }
};
</script>
<script defer="defer" src="https://fastly.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- end added 2025-04-14   增加对markdown中公式的支持 -->


  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>对现有系统做微服务化改造 &mdash; 新溪-gordon V2025.06 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="演进架构图" href="evolution-graph.html" />
    <link rel="prev" title="常用" href="normal.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>
  <script src="../../_static/js/jquery.min.js"></script>


<!-- 评论插件 gittalk start -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> -->
<!-- 评论插件 gittalk end -->


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> 新溪-gordon
          

          
          </a>

          
            
            
              <div class="version">
                V2025.06
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">关键知识</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../010architecture.html">010架构设计</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%9A%E5%8A%A1.html">互联网业务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/tmp.html">临时</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/other.html">其他架构设计</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/cqrs.html">CQRS </a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/crud.html">CRUD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/ddd.html">领域驱动设计</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/api.html">api设计</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/SSO.html">单点登录</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/event_driver.html">事件驱动架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/network_agent.html">网络代理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/message_bus.html">消息总线</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/mvc_mvp_mvvm.html">MVC MVP MVVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../normals/others/other.html">其他</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../history.html">架构的历史</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../historys/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historys/01origin_distributed_sys.html">原始分布式时代</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historys/02monolithic_sys.html">单体系统时代</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historys/03soa_sys.html">SOA架构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historys/04microService.html">微服务架构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../historys/04microServices/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/04microServices/9feature.html">微服务的九个核心的业务与技术特征</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/04microServices/ServiceMesh.html">ServiceMesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/04microServices/collect.html">微服务架构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../historys/05cloudnative.html">云原生时代——后微服务时代</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../historys/05cloudnatives/collect1.html">云原生</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/05cloudnatives/collect2.html">收集2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/05cloudnatives/12Factor.html">云原生应用的12要素</a></li>
<li class="toctree-l4"><a class="reference internal" href="../historys/05cloudnatives/distribute_architecture.html">从分布式架构到云原生架构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../historys/06serverless.html">无服务时代</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../historys/06serverless/collect1.html">Serverless</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture_design.html">软件架构设计</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture_designs/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_designs/history_design.html">架构设计的历史</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_designs/purpose.html">架构设计目的</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/1performance.html">复杂度来源-高性能</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/2availability.html">复杂度来源-高可用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/3expandability.html">复杂度来源-可扩展性</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/4lowcost.html">复杂度来源-低成本</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/5security.html">复杂度来源-安全</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/6scalability.html">复杂度来源-规模</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/purposes/7other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_designs/principle.html">架构设计原则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_designs/process.html">架构设计流程</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/process/1recognize.html">识别复杂度</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/process/2alternative.html">设计备选方案</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/process/3assess.html">评估&amp;选择备选方案</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_designs/process/4detailed.html">详细方案设计</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture_pattern.html">架构模式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture_patterns/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_patterns/performance.html">高性能架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/1read-write-seperate.html">读写分离</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/2split-db-table.html">分库分表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/3NoSQL.html">高性能 NoSQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/4cache.html">高性能缓存架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/5PPC-TPC.html">单服务器高性能模式: PPC&amp;TPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/6Reactor-Proactor.html">单服务器高性能模式: Reactor&amp;Proactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/performances/7slb.html">高性能负载均衡: 分类&amp;架构&amp;算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_patterns/availability.html">高可用架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/1CAP.html">CAP理论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/2FMEA.html">FMEA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/3storage.html">存储高可用架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/4computing.html">计算高可用架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/5different-live.html">异地多活</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/availabilitys/6api-failure.html">接口级故障&amp;应对</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../architecture_patterns/expandability.html">可扩展架构模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/1basic-ideas-and-pattern.html">可扩展架构的基本思想和模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/2hierarchical.html">传统可扩展架构-分层架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/3soa.html">传统可扩展架构-SOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/4microservice.html">微服务架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture_patterns/expandabilitys/5microkernel.html">微内核架构</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../communication_pattern.html">通信模式communication patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../communication_patterns/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../communication_patterns/SAP.html">SAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../communication_patterns/theory.html">理论</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../evolution.html">架构演进/重构</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="normal.html">常用</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">对现有系统做微服务化改造</a></li>
<li class="toctree-l3"><a class="reference internal" href="evolution-graph.html">演进架构图</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graph.html">架构图</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../graphs/normal.html">常用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../graphs/normals/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphs/normals/color.html">颜色</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphs/normals/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../graphs/business.html">业务架构图</a></li>
<li class="toctree-l3"><a class="reference internal" href="../graphs/c4-model.html">软件架构——C4模型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../graphs/%E6%9E%B6%E6%9E%84%E5%9B%BE%E6%8A%80%E5%B7%A7.html">架构图技巧</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../EA.html">EA企业级架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../EAs/TOGAF.html">TOGAF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../EAs/Zachman.html">Zachman扎克曼框架</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../011distributed.html">011分布式系统</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../011distributeds/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/normals/normal.html">分布式系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/normals/concept.html">并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/normals/tmp.html">临时</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../011distributeds/theory.html">并发相关理论</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/CAP.html">并发相关-CAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/PACELC.html">PACELC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/FLP.html">并发相关-FLP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/DLS.html">DLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/CSP.html">并发模型-CSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/CAS.html">CAS 机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/Actor.html">并发模型-Actor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/Gossip.html">Gossip协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/BASE.html">BASE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/ACID.html">ACID原则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/UUID.html">UUID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/theorys/consistent_hash.html">一致性hash</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../011distributeds/transaction.html">事务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/transactions/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/transactions/local.html">本地事务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/transactions/global.html">全局事务(Global Transactions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/transactions/share.html">共享事务(Share Transactions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/transactions/distribute.html">分布式事务</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../011distributeds/transactions/distributes/reliable_event_queue.html">可靠事件队列</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../011distributeds/transactions/distributes/SAGA.html">SAGA 事务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../011distributeds/transactions/distributes/TCC.html">TCC 事务</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../011distributeds/consensus.html">分布式共识</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/consensus/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/consensus/Paxos.html">Paxos算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/consensus/zab.html">zab协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../011distributeds/consensus/Raft.html">The Raft Consensus Algorithm </a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../012SoftEngineering.html">012软件工程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/methodology.html">编程方法论</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/code-quality.html">代码质量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/normals/complexity.html">复杂度</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/Programming-Spec.html">编程规范</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/Refactor.html">重构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/5W2H.html">5W2H 分析法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html">重构手段-单元测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id3">定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id4">作用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id5">如何编写单元测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#id6">为何难落地执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-unit.html#anti-patterns">影响可测试性的 Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/approach-decoupling.html">重构手段-解耦</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../012SoftEngineerings/Refactors/code-standard.html">改善代码质量的编程规范</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../012SoftEngineerings/document.html">设计文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../021microservice.html">021微服务架构</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/discovery.html">服务注册&amp;发现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/api_gateway.html">API网关</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/contract.html">对比</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../021microservices/tmp.html">临时</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../022middle-platform.html">022中台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../031dataanalysis.html">031数据分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/data.html">数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../031dataanalysis/tmp.html">临时</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../041governance.html">041服务治理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../041governances/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/technical-debt.html">技术债</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/anti-fragile.html">反脆弱</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../041governances/normals/code-review.html">Code Review</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../041governances/service_protection.html">服务保护</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../051compiler.html">051编译原理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/tool.html">工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80.html">汇编语言</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90.html">词法分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90.html">词法分析, 语法分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90.html">语义分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/LLVM.html">LLVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/IR.html">编译期后端技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../051compilers/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../052composition-principle.html">052 计算机组成原理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/CPU%20%E5%8E%82%E5%95%86.html">CPU 厂商</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/CPU%20Arch.html">CPU 架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/Arm.html">Arm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/X86.html">X86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../052composition-principles/API.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../053os.html">053操作系统</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../053os/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../053os/signal.html">signal信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../053os/other.html">其他</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../054algorithm.html">054算法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/algorithm.html">经典算法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/nlp.html">NLP相关算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/algorithms/encrypt.html">加密相关算法</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/tree.html">树结构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/b-tree.html">b-树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/b%2Btree.html">b+树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/lsm_tree.html">LSM树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/balanced_binary_tree.html">平衡二叉树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/red_black_tree.html">红黑树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/trie-tree.html">Trie 树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../054algorithms/trees/merkle-tree.html">Merkle 树</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/example.html">实例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/website.html">网站</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/iq.html">智力题</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/graph_theory.html">图论</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../054algorithms/other.html">其他算法</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">新溪-gordon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../010architecture.html">010架构设计</a> &raquo;</li>
        
          <li><a href="../evolution.html">架构演进/重构</a> &raquo;</li>
        
      <li>对现有系统做微服务化改造</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/010architectures/evolutions/be-microservice.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            <nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
              <h4 id="local-table-of-contents-title">On This Page</h4>
              <ul>
<li><a class="reference internal" href="#">对现有系统做微服务化改造</a><ul>
<li><a class="reference internal" href="#id3">微服务改造过程</a></li>
<li><a class="reference internal" href="#id4">准备阶段</a><ul>
<li><a class="reference internal" href="#id5">1. 圈表</a></li>
<li><a class="reference internal" href="#sql">2. 收集 SQL</a></li>
<li><a class="reference internal" href="#id6">3. 拆分 SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">实施阶段</a><ul>
<li><a class="reference internal" href="#id8">4. 构建微服务</a></li>
<li><a class="reference internal" href="#id9">5. 接入微服务</a></li>
<li><a class="reference internal" href="#id10">6. 数据库独立</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11">总结</a></li>
<li><a class="reference internal" href="#id12">参考</a></li>
</ul>
</li>
</ul>

            </nav>
  <table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
<section id="id2">
<h1>对现有系统做微服务化改造<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h1>
<p>相比从头开始落地服务，对现有系统做微服务化改造，面临更多的挑战:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 应用和数据表紧密耦合在一起，代码模块和表是多对多的依赖关系
    一个模块会访问多张表，多个模块也会对同一张表进行访问
    而且由于表都在一个数据库里，开发人员往往会随意对表做关联，有时候甚至 Join 5~6 张表以上
    这样，代码模块和表之间的关系是剪不断，理还乱
    我们很难清晰地划分代码和数据表的边界，也就很难把它们封装成独立的微服务
2. 如何保证系统的平滑过渡
    系统现在已经在运行了，我们的改造不能影响业务的稳定性
    微服务落地后，现有的系统要怎么对接微服务，数据要怎么迁移
</pre></div>
</div>
<p>应对这些挑战:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 要保证比较合理的服务设计，才能达到优化系统架构的目的
2. 要做到整个过程对现有系统的影响比较小，才能达到系统改造顺利落地的目的
</pre></div>
</div>
<p>单体系统的维护带来了一系列的问题:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 从应用方面来说，各个系统功能重复建设
    比如:很多系统都会直接访问库存相关的表，类似的库存逻辑散布在很多地方
    另外，如果修改了库存表的某个字段，这些系统同时会受影响，正所谓牵一发而动全身
2. 从数据库方面来说，数据库的可用性是比较差的
    如果某个系统有慢查询，它就很可能拖垮整个产品数据库，导致它不可用
    还有，这么多系统同时访问产品库，数据库的连接数也经常不够用
</pre></div>
</div>
<section id="id3">
<h2>微服务改造过程<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<p>选择要改造的服务:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>这里涉及了多个微服务，如果同时进行服务化改造的话，牵扯太大，很难落地。
于是，我们选择从库存微服务开始:
1. 库存的业务很重要，库存的规则也比较复杂，如果我们能够对库存逻辑进行优化，这会带来明显的业务价值
2. 电商的库存概念相对独立，涉及的表也比较少，我们可以相对容易地把它从现有体系中剥离出来
</pre></div>
</div>
<p>整个改造过程，一共分为两个阶段:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 准备阶段
    这个阶段为微服务改造做好前期的准备工作，具体步骤包括了:
    a. 圈表
    b. 收集 SQL
    c. SQL 拆分
2. 实施阶段
    这个阶段实际落地微服务，具体步骤包括:
    a. 微服务开发
    b. 服务接入
    c. 数据库独立
</pre></div>
</div>
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice1.jpeg" src="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice1.jpeg" />
</section>
<section id="id4">
<h2>准备阶段<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h2>
<section id="id5">
<h3>1. 圈表<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h3>
<p>圈表就是用来确定库存微服务具体包含哪些表，也就是确定服务的数据模型:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>在确定了表以后，库存微服务就负责这些表的访问:
1. 库存微服务也不会访问其它的表
2. 而业务系统后续将通过库存微服务的接口，实现对这些表的访问
</pre></div>
</div>
<p>圈表是微服务改造中比较有挑战性的地方:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>它实际上对应了服务的边界划分
只是针对老系统做服务化改造的时候，更多的是从数据库表的角度来考虑划分，这样更好落地
</pre></div>
</div>
<p>要求:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 要满足所有的库存访问需求，这些表之间关系紧密，和其它的表关联不大
2. 这些表的数量不能太多，一般不超过十几张
这样，我们既容易拆分数据库，又能控制服务的粒度，保证功能聚焦
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>在微服务改造中，确定哪些表属于这个服务，会直接影响后续的所有改造工作，这需要有经验的业务架构师和数据架构师参与进来，通过深入地分析现有的业务场景和表的关系，才能对库表进行合理的划分。</p>
</div>
<p>对现有系统的改造，服务的边界划分主要是从圈表入手的，而不是从一个服务应该有哪些功能入手的，这一点和新服务设计是有所不同的。这有两方面原因:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 如果确定了服务包含哪些表，也就大致确定了服务有哪些功能
    而表是现成的，它比业务功能要直观很多，所以从表入手比较高效
2. 如果从表入手，构造的服务和表是对应的，服务包含的是完整的表
    不会产生一个表的一部分字段属于库存服务，而另一部分字段属于别的服务的情况
    避免表字段的拆分带来额外的复杂性
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>因为这是对现有系统的改造，为了避免一下子引入太多变化，我们先不对库存的表结构进行调整，表结构的优化可以放在服务的升级版里做，这样对业务系统的影响也最小</p>
</div>
</section>
<section id="sql">
<h3>2. 收集 SQL<a class="headerlink" href="#sql" title="此标题的永久链接">¶</a></h3>
<p>在确定了哪些表属于库存服务后，我们会收集所有业务系统访问这些表的 SQL 语句:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>包括它的业务场景说明、访问频率等等。
库存微服务后续就针对这些 SQL 进行封装，提供相应的接口给业务系统使用。
</pre></div>
</div>
<p>这里，服务开发团队负责提供 SQL 收集的 Excel 模板，各业务系统开发团队负责收集具体的 SQL。</p>
</section>
<section id="id6">
<h3>3. 拆分 SQL<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h3>
<p>对于收集过来的 SQL 语句，有些 SQL 不仅仅访问圈定的这几张库存表，还会和产品库中的其他表进行关联。</p>
<p>对于这样的 SQL 语句，我们就要求各个业务团队先进行拆分，保证最后提供给服务开发团队的 SQL，只包含访问库存的相关表。通过 SQL 拆分，我们切断了库存表和其他表的直接联系，等后面微服务落地后，业务系统就可以通过接入微服务，完成现有 SQL 的替换。
SQL 拆分，会涉及一定的业务系统改造，这部分工作主要由各个研发团队负责，一般情况下，性能可能会受些影响，但问题不是很大。</p>
</section>
</section>
<section id="id7">
<h2>实施阶段<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h2>
<section id="id8">
<h3>4. 构建微服务<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h3>
<p>包括:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>接口设计、代码开发、功能测试等步骤

对业务方提供的 SQL 进行梳理，然后对接口做一定的通用化设计，
避免为每个 SQL 定制一个单独的接口，以此保证服务的复用能力
</pre></div>
</div>
<p>这部分工作由微服务开发团队负责:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>第一版的服务主要是:
    1. 做好接口设计
    2. 聚焦业务功能
    以保证服务能够落地，业务系统能够顺利对接为目标

将来:
    服务可以持续迭代，内部做各种技术性优化，
    只要服务的接口保持不变，就不会影响业务系统
</pre></div>
</div>
</section>
<section id="id9">
<h3>5. 接入微服务<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h3>
<p>库存服务经过功能和性能验证以后，会由各个业务开发团队逐步接入，替换原来的 SQL 语句。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>这部分工作主要由业务研发团队负责，难度不大，但需要耗费比较多的时间。</p>
</div>
</section>
<section id="id10">
<h3>6. 数据库独立<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>当服务接入完成，所有的 SQL 语句都被替换后，业务系统已经不会直接访问这些库存的表。这时，我们就可以把库存相关的表，从原来的产品库中迁移出来，部署成为一个物理上独立的数据库。业务系统是通过服务来访问数据库的，因此，这个数据迁移对于业务系统来说是透明的，业务团队甚至都不用关心这些表的新位置。</p>
</div>
<p>通过库存表独立成库，我们可以从物理层面，切断业务团队对这些表的依赖，同时，也可以大幅度降低产品库的压力，特别是大促的时候，库存读写压力是非常大的，数据库独立也为库存服务后续的技术优化打下了基础。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>这部分工作主要由微服务开发团队和 DBA 一起配合完成，主要是要避免业务系统还有遗漏的 SQL 语句，避免它们还在直接访问库存的表。我们可以在迁库前，通过代码扫描做好相应的检查工作。</p>
</div>
</section>
</section>
<section id="id11">
<h2>总结<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h2>
<figure class="align-default" id="id14">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice2.jpeg" src="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice2.jpeg" />
<figcaption>
<p><span class="caption-text">改造前架构图</span><a class="headerlink" href="#id14" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id15">
<img alt="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice3.jpeg" src="https://img.zhaoweiguo.com/knowledge/images/architectures/evolutions/be-microservice3.jpeg" />
<figcaption>
<p><span class="caption-text">改造后架构图</span><a class="headerlink" href="#id15" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>系统改造不会产生直接的业务价值，对于业务开发团队来说，他们往往还需要承担大量新需求的开发工作。所以，<strong>从项目推进的角度来看，这种核心服务的改造，很多时候都是技术一把手工程。</strong> 在微服务改造过程中，老板要高度重视，大家事先定好时间计划，每周 Review 进度，协调各个团队工作的优先级，确保改造的顺利落地。</p>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>基于现有系统进行改造和全新的服务设计是有所不同的，我们不能追求理想化和一步到位，而是要考虑到系统的平滑过渡，先实现微服务的顺利落地，后续再考虑各种优化。</p>
</div>
</section>
<section id="id12">
<h2>参考<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>【极客】架构实战案例-可复用架构案例（二）：如何对现有系统做微服务改造: <a class="reference external" href="https://time.geekbang.org/column/article/209597">https://time.geekbang.org/column/article/209597</a></p></li>
</ul>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evolution-graph.html" class="btn btn-neutral float-right" title="演进架构图" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="normal.html" class="btn btn-neutral" title="常用" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  <div id="gitalk-container"></div>
  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2025, 新溪-gordon.

    </p>
  </div>
  <div>备案号 <a href="http://www.beian.miit.gov.cn">京ICP备16018553号</a></div><div>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a></div>. 


</footer>

<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?042289284b8eb33866001347a3e0b129";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>     
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'V2025.06',
            LANGUAGE:'zh-CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });


      // var gitalk = new Gitalk({
      //         clientID: '565177626b5d46427009',
      //         clientSecret: 'b2a36e67e1d2a73e43667f46d571c2624f8e1026',
      //         repo: 'knowledge',
      //         owner: 'zhaoweiguo',
      //         admin: ['zhaoweiguo'],
      //         id: location.pathname,      // Ensure uniqueness and length less than 50
      //         distractionFreeMode: false  // Facebook-like distraction free mode
      //       })
      // gitalk.render('gitalk-container')

  </script>


<script type="text/javascript" src="../../_static/js/table-of-contents-sidebar.js"></script>
<!-- <script type="text/javascript" src="https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/table-of-contents-sidebar.js"></script> -->
<script type="text/javascript">
    window.onload = function(e){
        TableOfContents.init({
            basePath: "https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/",
            querySelector: "body" // or other css querySelector
        });
    }
</script> 

</body>
</html>