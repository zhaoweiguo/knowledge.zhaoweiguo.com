

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.2.4. Datasets &mdash; 新溪-gordon V1.7.9 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="3.2.5. Transformers" href="Transformers.html" />
    <link rel="prev" title="3.2.3. Hub Python Library" href="lib_python.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>



</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> 新溪-gordon
          

          
          </a>

          
            
            
              <div class="version">
                V1.7.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">AI</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../normal.html">1. 常用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../normals/normal.html">1.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/AIGC.html">1.2. AIGC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/concept.html">1.3. 关键定义</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/ml.html">1.4. 机器学习machine learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/bi.html">1.5. BI(Business Intelligence)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/monitor.html">1.6. monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/Kaggle.html">1.7. Kaggle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../normals/question.html">1.8. 常见问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">2. 理论</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../theories/math.html">2.1. 数学</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../theories/bag-of-words.html">2.2. bag-of-words</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../theories/overfitting-underfitting.html">2.3. overfitting&amp;underfitting</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../LLM.html">3. 大模型</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../normal.html">3.1. 常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../normals/normal.html">3.1.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/package.html">3.1.2. 依赖安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/encoder.html">3.1.3. 编码-解码器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normals/tmp.html">3.1.4. 临时</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../huggingface.html">3.2. huggingface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="normal.html">3.2.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="huggingface_hub.html">3.2.2. Hugging Face Hub</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib_python.html">3.2.3. Hub Python Library</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.2.4. Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="Transformers.html">3.2.5. Transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="Evaluate.html">3.2.6. Evaluate</a></li>
<li class="toctree-l3"><a class="reference internal" href="PEFT.html">3.2.7. PEFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="collect.html">3.2.8. 收集</a><ul>
<li class="toctree-l4"><a class="reference internal" href="collects/dataset.html">dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="collects/resources.html">resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="collects/evaluate.html">evaluate</a></li>
<li class="toctree-l4"><a class="reference internal" href="collects/model.html">model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model.html">3.3. 著名模型</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/LLaMA.html">3.3.1. LLaMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/ChatGLM.html">3.3.2. ChatGLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/BERT.html">3.3.3. BERT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/GPT.html">3.3.4. GPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/BART.html">3.3.5. BART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/T5.html">3.3.6. T5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/ChatRWKV.html">3.3.7. ChatRWKV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/GGML.html">3.3.8. GGML</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/Open-Assistant.html">3.3.9. Open-Assistant</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tune.html">3.4. 调优</a></li>
<li class="toctree-l2"><a class="reference internal" href="../opensource.html">3.5. 开源项目</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openai.html">3.6. 商业项目</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../openais/normal.html">3.6.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../openais/chatgpt.html">3.6.2. ChatGPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../openais/chatgpts/normal.html">常用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../openais/chatgpts/prompt.html">Prompt 提示词</a></li>
<li class="toctree-l4"><a class="reference internal" href="../openais/chatgpts/skill.html">示例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../openais/Claude.html">3.6.3. Claude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../openais/midjourney.html">3.6.4. midjourney</a></li>
<li class="toctree-l3"><a class="reference internal" href="../openais/Copilot.html">3.6.5. Copilot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../openais/%E9%98%BF%E9%87%8C%E9%80%9A%E4%B9%89%E5%8D%83%E9%97%AE.html">3.6.6. 阿里通义千问</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../NLP.html">4. NLP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../NLPs/normal.html">4.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../NLPs/preprocess.html">4.2. 预处理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/normal.html">4.2.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/NER.html">4.2.2. NER-命名实体识别</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E5%85%B3%E9%94%AE%E8%AF%8D%E6%8F%90%E5%8F%96.html">4.2.3. 关键词提取</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E5%88%86%E8%AF%8D.html">4.2.4. 分词</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90.html">4.2.5. 情感分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA.html">4.2.6. 文本表示</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6.html">4.2.7. 注意力机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../NLPs/preprocesses/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B.html">4.2.8. 语言模型</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../OCR.html">5. OCR</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../OCRs/normal.html">5.1. 常用</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../library.html">6. 函数库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/normal.html">6.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Image.html">6.2. Image图像处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Video.html">6.3. Video视频</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/IPython.html">6.4. IPython</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/IPythons/normal.html">6.4.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/IPythons/magic.html">6.4.2. 魔法命令 </a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/IPythons/display.html">6.4.3. display函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Jupyter.html">6.5. Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/NumPy.html">6.6. NumPy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/NumPys/normal.html">6.6.1. 通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/NumPys/Ndarray.html">6.6.2. Ndarray 对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/NumPys/function.html">6.6.3. 通用函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Pandas.html">6.7. Pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/normal.html">6.7.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/example_subset.html">6.7.2. 实例-subset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/example_analysis.html">6.7.3. 实例-统计分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/example_sql.html">6.7.4. 利用pandas实现SQL操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/example_default_value.html">6.7.5. 实例-缺失值的处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/example_multi_index.html">6.7.6. 多层索引的使用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/practice.html">6.7.7. 实践</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Pandas/practices/practice_2012ObamaElect.html">实践-2012年奥巴马总统连任选举</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/api_input_output.html">6.7.8. API-输入输出</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/api_General.html">6.7.9. API-General functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/api_Series.html">6.7.10. API-Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/api_DataFrame.html">6.7.11. API-DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Pandas/api_Index.html">6.7.12. API-index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Matplotlib.html">6.8. Matplotlib</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/normal.html">6.8.1. 基本</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/install.html">6.8.2. 安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/pyplot.html">6.8.3. pyplot </a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/matplotlib.patches.html">6.8.4. matplotlib.patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/example.html">6.8.5. 实例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/plot.html">折线图plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/bar.html">条形图bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/hist.html">直方图hist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/scatter.html">散点图scatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/stackplot.html">面积图stackplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/pie.html">饼图pie</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/box.html">箱型图box</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/Matplotlibs/examples/multi.html">多图合并multi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Matplotlibs/pylab.html">6.8.6. pylab子包</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/SciPy.html">6.9. SciPy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/SciPys/normal.html">6.9.1. 常用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/sklearn.html">6.10. sklearn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/sklearns/normal.html">6.10.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/sklearns/supervised.html">6.10.2. 监督学习</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libraries/sklearns/superviseds/glm.html">广义线性模型</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/sklearns/unsupervised.html">6.10.3. 无监督学习</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/statsmodels.html">6.11. statsmodels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/OpenCV.html">6.12. OpenCV</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/OpenCVs/normal.html">6.12.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/OpenCVs/example.html">6.12.2. 实例</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/OpenCVs/struct.html">6.12.3. 代码类结构</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/Seaborn.html">6.13. Seaborn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/Seaborns/normal.html">6.13.1. 常用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/skl2onnx.html">6.14. skl2onnx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/jieba.html">6.15. jieba中文分词</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/gensim.html">6.16. gensim: 文本主题建模和相似性分析</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/gensims/normal.html">6.16.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/gensims/Core_Tutorials.html">6.16.2. Core Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/gensims/Tutorials.html">6.16.3. Tutorials: Learning Oriented Lessons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/gensims/How-to_Guides.html">6.16.4. How-to Guides: Solve a Problem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/ONNX.html">6.17. ONNX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/ONNXs/ONNX.html">6.17.1. ONNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libraries/ONNXs/onnxruntime.html">6.17.2. onnxruntime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/ncnn.html">6.18. ncnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libraries/LAC.html">6.19. LAC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../framework.html">7. 学习框架</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/normal.html">7.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/mxnet.html">7.2. mxnet库</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/mxnets/ndarray.html">7.2.1. nd模块</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../frameworks/mxnets/ndarrays/ndarray.html">ndarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../frameworks/mxnets/ndarrays/ndarray.random.html">ndarray.random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/mxnets/gluon.html">7.2.2. gluon模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/mxnets/autograd.html">7.2.3. autograd模块</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/pytorch.html">7.3. PyTorch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/pytorchs/normal.html">7.3.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/pytorchs/nn.html">7.3.2. nn模块</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/tensorflow.html">7.4. tensorflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/Keras.html">7.5. Keras</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/Keras/normal.html">7.5.1. 常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../frameworks/Keras/demo.html">7.5.2. 实例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../frameworks/Keras/demos/binary_classification.html">二分类问题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../frameworks/Keras/demos/multiclass_classification.html">多分类问题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../frameworks/Keras/demos/regression.html">回归问题</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../frameworks/other.html">7.6. 其他</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../AIML.html">8. AIML</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../AIMLs/normal.html">8.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AIMLs/spec.html">8.2. AIML 2.1 Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm.html">9. 相关算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deep_learning.html">10. 深度学习</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/normal.html">10.1. 常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/history.html">10.2. 历史</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/ann.html">10.3. ANN(NN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/dnn.html">10.4. 深度神经网络(Deep Neural Network, DNN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/cnn.html">10.5. 卷积神经网络(Convolutional Neural Network, CNN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/rnn.html">10.6. RNN: 循环神经网(Recurrent Neural Network, RNN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/lstm.html">10.7. LSTM: 长短时记忆(Long Short Term Memory, LSTM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learnings/relu.html">10.8. ReLU(激活函数)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../opensource.html">11. 开源项目</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../opensources/alphaGo.html">11.1. AlphaGo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opensources/kubeflow.html">11.2. kubeflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opensources/normal.html">11.3. 常用</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset.html">12. 数据集</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tool.html">13. 工具</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">新溪-gordon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../LLM.html"><span class="section-number">3. </span>大模型</a> &raquo;</li>
        
          <li><a href="../huggingface.html"><span class="section-number">3.2. </span>huggingface</a> &raquo;</li>
        
      <li><span class="section-number">3.2.4. </span>Datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/LLMs/huggingfaces/Datasets.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            <nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
              <h4 id="local-table-of-contents-title">On This Page</h4>
              <ul>
<li><a class="reference internal" href="#">3.2.4. Datasets</a><ul>
<li><a class="reference internal" href="#tutorials">TUTORIALS</a><ul>
<li><a class="reference internal" href="#load-a-dataset-from-the-hub">Load a dataset from the Hub</a><ul>
<li><a class="reference internal" href="#load-a-dataset">Load a dataset</a></li>
<li><a class="reference internal" href="#splits">Splits</a></li>
<li><a class="reference internal" href="#configurations">Configurations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#know-your-dataset">Know your dataset</a><ul>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#iterabledataset">IterableDataset</a></li>
<li><a class="reference internal" href="#preprocess">Preprocess</a><ul>
<li><a class="reference internal" href="#tokenize-text">Tokenize text</a></li>
<li><a class="reference internal" href="#resample-audio-signals">Resample audio signals</a></li>
<li><a class="reference internal" href="#apply-data-augmentations">Apply data augmentations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluate-predictions">Evaluate predictions</a></li>
<li><a class="reference internal" href="#create-a-dataset">Create a dataset</a><ul>
<li><a class="reference internal" href="#folder-based-builders">Folder-based builders</a></li>
<li><a class="reference internal" href="#from-local-files">From local files</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-guides">HOW-TO GUIDES</a><ul>
<li><a class="reference internal" href="#general-usage">General usage</a><ul>
<li><a class="reference internal" href="#load">Load</a></li>
<li><a class="reference internal" href="#process">Process</a><ul>
<li><a class="reference internal" href="#glue">glue数据</a></li>
<li><a class="reference internal" href="#imdb">imdb数据</a></li>
<li><a class="reference internal" href="#squad">SQuAD数据集</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stream">Stream</a></li>
</ul>
</li>
<li><a class="reference internal" href="#audio">Audio</a><ul>
<li><a class="reference internal" href="#load-audio-data">Load audio data</a></li>
<li><a class="reference internal" href="#process-audio-data">Process audio data</a></li>
<li><a class="reference internal" href="#create-an-audio-dataset">Create an audio dataset</a><ul>
<li><a class="reference internal" href="#local-files">Local files</a></li>
<li><a class="reference internal" href="#audiofolder">AudioFolder</a></li>
<li><a class="reference internal" href="#loading-script">Loading script</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#vision">Vision</a><ul>
<li><a class="reference internal" href="#load-image-data">Load image data</a><ul>
<li><a class="reference internal" href="#imagefolder">ImageFolder</a></li>
</ul>
</li>
<li><a class="reference internal" href="#process-image-data">Process image data</a><ul>
<li><a class="reference internal" href="#map">Map</a></li>
<li><a class="reference internal" href="#apply-transforms">Apply transforms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-an-image-dataset">Create an image dataset</a></li>
<li><a class="reference internal" href="#depth-estimation">Depth estimation</a></li>
<li><a class="reference internal" href="#image-classification">Image classification</a></li>
<li><a class="reference internal" href="#semantic-segmentation">Semantic segmentation</a></li>
<li><a class="reference internal" href="#object-detection">Object detection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#text">Text</a><ul>
<li><a class="reference internal" href="#load-text-data">Load text data</a></li>
<li><a class="reference internal" href="#process-text-data">Process text data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tabular">Tabular</a><ul>
<li><a class="reference internal" href="#csv-files">CSV files</a></li>
<li><a class="reference internal" href="#pandas-dataframes">Pandas DataFrames</a></li>
<li><a class="reference internal" href="#databases">Databases</a><ul>
<li><a class="reference internal" href="#sqlite">SQLite</a></li>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dataset-repository">Dataset repository</a><ul>
<li><a class="reference internal" href="#share">Share</a></li>
<li><a class="reference internal" href="#create-a-dataset-loading-script">Create a dataset loading script</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
  <table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
<section id="datasets">
<h1><span class="section-number">3.2.4. </span>Datasets<a class="headerlink" href="#datasets" title="此标题的永久链接">¶</a></h1>
<ul class="simple">
<li><p>Datasets is a library for easily accessing and sharing datasets for Audio, Computer Vision, and Natural Language Processing (NLP) tasks.</p></li>
</ul>
<p>pip安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">datasets</span>
<span class="c1"># check</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;from datasets import load_dataset; print(load_dataset(&#39;squad&#39;, split=&#39;train&#39;)[0])&quot;</span>

<span class="c1"># Audio</span>
<span class="n">pip</span> <span class="n">install</span> <span class="s1">&#39;datasets[audio]&#39;</span>
<span class="c1"># check</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;import soundfile; print(soundfile.__libsndfile_version__)&quot;</span>

<span class="c1"># Vision</span>
<span class="n">pip</span> <span class="n">install</span> <span class="s1">&#39;datasets[vision]&#39;</span>
</pre></div>
</div>
<p>源码安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">huggingface</span><span class="o">/</span><span class="n">datasets</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">datasets</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<section id="tutorials">
<h2>TUTORIALS<a class="headerlink" href="#tutorials" title="此标题的永久链接">¶</a></h2>
<section id="load-a-dataset-from-the-hub">
<h3>Load a dataset from the Hub<a class="headerlink" href="#load-a-dataset-from-the-hub" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>This tutorial uses the <a class="reference external" href="https://huggingface.co/datasets/rotten_tomatoes">rotten_tomatoes</a> and <a class="reference external" href="https://huggingface.co/datasets/PolyAI/minds14">MInDS_14</a> datasets</p></li>
</ul>
<section id="load-a-dataset">
<h4>Load a dataset<a class="headerlink" href="#load-a-dataset" title="此标题的永久链接">¶</a></h4>
<p>load_dataset_builder():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset_builder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_builder</span> <span class="o">=</span> <span class="n">load_dataset_builder</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">)</span>

<span class="go"># Inspect dataset description</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_builder</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">description</span>
<span class="go">Movie Review Dataset.</span>
<span class="go">This is a dataset of containing 5,331 positive and 5,331 negative processed sentences from Rotten Tomatoes movie reviews.</span>
<span class="go">This data was first used in Bo Pang and Lillian Lee,</span>
<span class="go">        ``Seeing stars: Exploiting class relationships for sentiment categorization with respect to rating scales.&#39;&#39;, Proceedings of the ACL, 2005.</span>


<span class="go"># Inspect dataset features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_builder</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">features</span>
<span class="go">{&#39;label&#39;: ClassLabel(num_classes=2, names=[&#39;neg&#39;, &#39;pos&#39;], id=None),</span>
<span class="go"> &#39;text&#39;: Value(dtype=&#39;string&#39;, id=None)}</span>
</pre></div>
</div>
<p>load_dataset():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span>
<span class="go">Dataset({</span>
<span class="go">    features: [&#39;text&#39;, &#39;label&#39;],</span>
<span class="go">    num_rows: 8530</span>
<span class="go">})</span>
</pre></div>
</div>
</section>
<section id="splits">
<h4>Splits<a class="headerlink" href="#splits" title="此标题的永久链接">¶</a></h4>
<p>get_dataset_split_names():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">get_dataset_split_names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_dataset_split_names</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">)</span>
<span class="go">[&#39;train&#39;, &#39;validation&#39;, &#39;test&#39;]</span>
</pre></div>
</div>
<p>前面load_dataset()函数指定了split，如果不指定:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span>
<span class="go">DatasetDict({</span>
<span class="go">    train: Dataset({</span>
<span class="go">        features: [&#39;text&#39;, &#39;label&#39;],</span>
<span class="go">        num_rows: 8530</span>
<span class="go">    })</span>
<span class="go">    validation: Dataset({</span>
<span class="go">        features: [&#39;text&#39;, &#39;label&#39;],</span>
<span class="go">        num_rows: 1066</span>
<span class="go">    })</span>
<span class="go">    test: Dataset({</span>
<span class="go">        features: [&#39;text&#39;, &#39;label&#39;],</span>
<span class="go">        num_rows: 1066</span>
<span class="go">    })</span>
<span class="go">})</span>
</pre></div>
</div>
</section>
<section id="configurations">
<h4>Configurations<a class="headerlink" href="#configurations" title="此标题的永久链接">¶</a></h4>
<p>get_dataset_config_names():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">get_dataset_config_names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">configs</span> <span class="o">=</span> <span class="n">get_dataset_config_names</span><span class="p">(</span><span class="s2">&quot;PolyAI/minds14&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
<span class="go">[&#39;cs-CZ&#39;, &#39;de-DE&#39;, &#39;en-AU&#39; ...]</span>
</pre></div>
</div>
<p>Then load the configuration you want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">mindsFR</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;PolyAI/minds14&quot;</span><span class="p">,</span> <span class="s2">&quot;fr-FR&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="know-your-dataset">
<h3>Know your dataset<a class="headerlink" href="#know-your-dataset" title="此标题的永久链接">¶</a></h3>
<section id="dataset">
<h4>Dataset<a class="headerlink" href="#dataset" title="此标题的永久链接">¶</a></h4>
<p>加载数据:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Indexing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;label&#39;: 1,</span>
<span class="go"> &#39;text&#39;: &#39;the rock is des...&#39;}</span>

<span class="go"># a list of all the values in the column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
<span class="go">[</span>
<span class="go">        &#39;the rock is desti...&#39;,</span>
<span class="go">        &#39;the gorgeously elabora...&#39;,</span>
<span class="go">        ...,</span>
<span class="go">        &#39;things really ...&#39;</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Slicing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">{&#39;label&#39;: [1, 1, 1],</span>
<span class="go"> &#39;text&#39;:</span>
<span class="go">        [</span>
<span class="go">                &#39;the rock is desti...&#39;,</span>
<span class="go">                &#39;the gorgeously elabora...&#39;,</span>
<span class="go">                ...,</span>
<span class="go">                &#39;things really ...&#39;</span>
<span class="go">        ]</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">...</span>
</pre></div>
</div>
</section>
<section id="iterabledataset">
<h4>IterableDataset<a class="headerlink" href="#iterabledataset" title="此标题的永久链接">¶</a></h4>
<p>An IterableDataset is loaded when you set the streaming parameter to True in load_dataset():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iterable_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;food101&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">iterable_dataset</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="gp">... </span>   <span class="k">break</span>
<span class="go">{&#39;image&#39;: &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=384x512 at 0x7F0681F5C520&gt;, &#39;label&#39;: 6}</span>


<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">iterable_dataset</span><span class="p">))</span>
<span class="go">{&#39;image&#39;: &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=384x512 at 0x7F0681F59B50&gt;,</span>
<span class="go"> &#39;label&#39;: 6}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">iterable_dataset</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="gp">... </span>   <span class="k">break</span>
<span class="go">{&#39;image&#39;: &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=384x512 at 0x7F7479DE82B0&gt;, &#39;label&#39;: 6}</span>
</pre></div>
</div>
<p>使用 IterableDataset.take（） 返回包含特定数量示例的数据集子集:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get first three examples</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable_dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="p">[{</span><span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">PIL</span><span class="o">.</span><span class="n">JpegImagePlugin</span><span class="o">.</span><span class="n">JpegImageFile</span> <span class="n">image</span> <span class="n">mode</span><span class="o">=</span><span class="n">RGB</span> <span class="n">size</span><span class="o">=</span><span class="mi">384</span><span class="n">x512</span> <span class="n">at</span> <span class="mh">0x7F7479DEE9D0</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">PIL</span><span class="o">.</span><span class="n">JpegImagePlugin</span><span class="o">.</span><span class="n">JpegImageFile</span> <span class="n">image</span> <span class="n">mode</span><span class="o">=</span><span class="n">RGB</span> <span class="n">size</span><span class="o">=</span><span class="mi">512</span><span class="n">x512</span> <span class="n">at</span> <span class="mh">0x7F7479DE8190</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">PIL</span><span class="o">.</span><span class="n">JpegImagePlugin</span><span class="o">.</span><span class="n">JpegImageFile</span> <span class="n">image</span> <span class="n">mode</span><span class="o">=</span><span class="n">RGB</span> <span class="n">size</span><span class="o">=</span><span class="mi">512</span><span class="n">x383</span> <span class="n">at</span> <span class="mh">0x7F7479DE8310</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}]</span>
</pre></div>
</div>
</section>
<section id="preprocess">
<h4>Preprocess<a class="headerlink" href="#preprocess" title="此标题的永久链接">¶</a></h4>
<section id="tokenize-text">
<h5>Tokenize text<a class="headerlink" href="#tokenize-text" title="此标题的永久链接">¶</a></h5>
<p>Start by loading the rotten_tomatoes dataset and the tokenizer corresponding to a pretrained BERT model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;bert-base-uncased&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;rotten_tomatoes&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Call your tokenizer on the first row of text in the dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tokenizer</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
<span class="go">{</span>
<span class="go"> &#39;input_ids&#39;: [101, 1103, 2067 ...],</span>
<span class="go"> &#39;token_type_ids&#39;: [0, 0, 0, 0, 0 ...],</span>
<span class="go"> &#39;attention_mask&#39;: [1, 1, 1, 1, 1 ...]</span>
<span class="go">}</span>
<span class="go">说明:</span>
<span class="go">        input_ids: the numbers representing the tokens in the text.</span>
<span class="go">        token_type_ids: indicates which sequence a token belongs to if there is more than one sequence.</span>
<span class="go">        attention_mask: indicates whether a token should be masked or not.</span>
</pre></div>
</div>
<p>The fastest way to tokenize your entire dataset is to use the map() function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tokenization</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tokenization</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Set the format of your dataset to be compatible with your machine learning framework:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pytorch</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;token_type_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;attention_mask&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">])</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

<span class="c1"># TensorFlow</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">DataCollatorWithPadding</span>
<span class="n">data_collator</span> <span class="o">=</span> <span class="n">DataCollatorWithPadding</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;tf&quot;</span><span class="p">)</span>
<span class="n">tf_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">to_tf_dataset</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;token_type_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;attention_mask&quot;</span><span class="p">],</span>
    <span class="n">label_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">collate_fn</span><span class="o">=</span><span class="n">data_collator</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="resample-audio-signals">
<h5>Resample audio signals<a class="headerlink" href="#resample-audio-signals" title="此标题的永久链接">¶</a></h5>
<p>Start by loading the MInDS-14 dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoFeatureExtractor</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span> <span class="n">Audio</span>

<span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">AutoFeatureExtractor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;facebook/wav2vec2-base-960h&quot;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;PolyAI/minds14&quot;</span><span class="p">,</span> <span class="s2">&quot;en-US&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When you call the audio column of the dataset, it is automatically decoded and resampled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span>
<span class="go">{&#39;array&#39;: array([ 0.        ,  0.00024414, -0.00024414, ..., -0.00024414,</span>
<span class="go">         0.        ,  0.        ], dtype=float32),</span>
<span class="go"> &#39;path&#39;: &#39;~/.cache/huggingface/datasets/downloads/extracted/xxxxx/en-US~JOINT_ACCOUNT/xxx.wav&#39;,</span>
<span class="go"> &#39;sampling_rate&#39;: 8000}</span>
</pre></div>
</div>
<p>Use the cast_column() function and set the sampling_rate parameter in the Audio feature to upsample the audio signal. When you call the audio column now, it is decoded and resampled to 16kHz:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">16_000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span>
<span class="go">{&#39;array&#39;: array([ 2.3443763e-05,  2.1729663e-04,  2.2145823e-04, ...,</span>
<span class="go">         3.8356509e-05, -7.3497440e-06, -2.1754686e-05], dtype=float32),</span>
<span class="go"> &#39;path&#39;: &#39;~/.cache/huggingface/datasets/downloads/extracted/xxx/en-US~JOINT_ACCOUNT/xxx.wav&#39;,</span>
<span class="go"> &#39;sampling_rate&#39;: 16000}</span>
</pre></div>
</div>
<p>Use the map() function to resample the entire dataset to 16kHz:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preprocess_function</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
    <span class="n">audio_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;array&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;audio&quot;</span><span class="p">]]</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">feature_extractor</span><span class="p">(</span>
        <span class="n">audio_arrays</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="n">feature_extractor</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">inputs</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">preprocess_function</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="apply-data-augmentations">
<h5>Apply data augmentations<a class="headerlink" href="#apply-data-augmentations" title="此标题的永久链接">¶</a></h5>
<ol class="arabic">
<li><p>Start by loading the Beans dataset, the Image feature, and the feature extractor corresponding to a pretrained ViT model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoFeatureExtractor</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span> <span class="n">Image</span>

<span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">AutoFeatureExtractor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;google/vit-base-patch16-224-in21k&quot;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;beans&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>When you call the image column of the dataset, the underlying PIL object is automatically decoded into an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>some transforms to the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">RandomRotation</span>

<span class="n">rotate</span> <span class="o">=</span> <span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">transforms</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
    <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;pixel_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rotate</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">examples</span>
</pre></div>
</div>
</li>
<li><p>Use the set_transform() function to apply the transform on-the-fly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;pixel_values&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="evaluate-predictions">
<h4>Evaluate predictions<a class="headerlink" href="#evaluate-predictions" title="此标题的永久链接">¶</a></h4>
<p>You can see what metrics are available with list_metrics():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">list_metrics</span>
<span class="n">metrics_list</span> <span class="o">=</span> <span class="n">list_metrics</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">metrics_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_list</span><span class="p">)</span>
</pre></div>
</div>
<p>Load metric:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a metric from the Hub with load_metric()</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_metric</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">load_metric</span><span class="p">(</span><span class="s1">&#39;glue&#39;</span><span class="p">,</span> <span class="s1">&#39;mrpc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Metrics object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">inputs_description</span><span class="p">)</span>
<span class="go">Compute GLUE evaluation metric associated to each GLUE dataset.</span>
<span class="go">Args:</span>
<span class="go">    predictions: list of predictions to score.</span>
<span class="go">        Each translation should be tokenized into a list of tokens.</span>
<span class="go">    references: list of lists of references for each translation.</span>
<span class="go">        Each reference should be tokenized into a list of tokens.</span>
<span class="go">Returns: depending on the GLUE subset, one or several of:</span>
<span class="go">    &quot;accuracy&quot;: Accuracy</span>
<span class="go">    &quot;f1&quot;: F1 score</span>
<span class="go">    &quot;pearson&quot;: Pearson Correlation</span>
<span class="go">    &quot;spearmanr&quot;: Spearman Correlation</span>
<span class="go">    &quot;matthews_correlation&quot;: Matthew Correlation</span>

<span class="go">Examples:</span>
<span class="go">        # &#39;sst2&#39; or any of [&quot;mnli&quot;, &quot;mnli_mismatched&quot;, &quot;mnli_matched&quot;, &quot;qnli&quot;, &quot;rte&quot;, &quot;wnli&quot;, &quot;hans&quot;]</span>
<span class="go">    &gt;&gt;&gt; glue_metric = datasets.load_metric(&#39;glue&#39;, &#39;sst2&#39;)</span>
<span class="go">    &gt;&gt;&gt; references = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; predictions = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; results = glue_metric.compute(predictions=predictions, references=references)</span>
<span class="go">    &gt;&gt;&gt; print(results)</span>
<span class="go">    {&#39;accuracy&#39;: 1.0}</span>

<span class="go">    &gt;&gt;&gt; glue_metric = datasets.load_metric(&#39;glue&#39;, &#39;mrpc&#39;)  # &#39;mrpc&#39; or &#39;qqp&#39;</span>
<span class="go">    &gt;&gt;&gt; references = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; predictions = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; results = glue_metric.compute(predictions=predictions, references=references)</span>
<span class="go">    &gt;&gt;&gt; print(results)</span>
<span class="go">    {&#39;accuracy&#39;: 1.0, &#39;f1&#39;: 1.0}</span>

<span class="go">    &gt;&gt;&gt; glue_metric = datasets.load_metric(&#39;glue&#39;, &#39;stsb&#39;)</span>
<span class="go">    &gt;&gt;&gt; references = [0., 1., 2., 3., 4., 5.]</span>
<span class="go">    &gt;&gt;&gt; predictions = [0., 1., 2., 3., 4., 5.]</span>
<span class="go">    &gt;&gt;&gt; results = glue_metric.compute(predictions=predictions, references=references)</span>
<span class="go">    &gt;&gt;&gt; print({&quot;pearson&quot;: round(results[&quot;pearson&quot;], 2), &quot;spearmanr&quot;: round(results[&quot;spearmanr&quot;], 2)})</span>
<span class="go">    {&#39;pearson&#39;: 1.0, &#39;spearmanr&#39;: 1.0}</span>

<span class="go">    &gt;&gt;&gt; glue_metric = datasets.load_metric(&#39;glue&#39;, &#39;cola&#39;)</span>
<span class="go">    &gt;&gt;&gt; references = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; predictions = [0, 1]</span>
<span class="go">    &gt;&gt;&gt; results = glue_metric.compute(predictions=predictions, references=references)</span>
<span class="go">    &gt;&gt;&gt; print(results)</span>
<span class="go">    {&#39;matthews_correlation&#39;: 1.0}</span>
</pre></div>
</div>
<p>Compute metric:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">model_inputs</span><span class="p">)</span>
<span class="n">final_score</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">predictions</span><span class="o">=</span><span class="n">model_predictions</span><span class="p">,</span> <span class="n">references</span><span class="o">=</span><span class="n">gold_references</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-a-dataset">
<h4>Create a dataset<a class="headerlink" href="#create-a-dataset" title="此标题的永久链接">¶</a></h4>
<section id="folder-based-builders">
<h5>Folder-based builders<a class="headerlink" href="#folder-based-builders" title="此标题的永久链接">¶</a></h5>
<ul class="simple">
<li><p>Folder-based builders for quickly creating an image or audio dataset</p></li>
</ul>
<figure class="align-default" id="id3">
<img alt="https://img.zhaoweiguo.com/uPic/2023/07/mxt9eY.jpg" src="https://img.zhaoweiguo.com/uPic/2023/07/mxt9eY.jpg" />
<figcaption>
<p><span class="caption-text">This is how the folder-based builder generates</span><a class="headerlink" href="#id3" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">ImageFolder</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imagefolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/pokemon&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">AudioFolder</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="from-local-files">
<h5>From local files<a class="headerlink" href="#from-local-files" title="此标题的永久链接">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gen</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;pokemon&quot;</span><span class="p">:</span> <span class="s2">&quot;bulbasaur&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;grass&quot;</span><span class="p">}</span>
<span class="gp">... </span>    <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;pokemon&quot;</span><span class="p">:</span> <span class="s2">&quot;squirtle&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;water&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_generator</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">IterableDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">IterableDataset</span><span class="o">.</span><span class="n">from_generator</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="go">{&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}</span>
<span class="go">{&quot;pokemon&quot;: &quot;squirtle&quot;, &quot;type&quot;: &quot;water&quot;}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;pokemon&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bulbasaur&quot;</span><span class="p">,</span> <span class="s2">&quot;squirtle&quot;</span><span class="p">],</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;grass&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">audio_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;audio&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path/to/audio_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;path/to/audio_n&quot;</span><span class="p">]})</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="how-to-guides">
<h2>HOW-TO GUIDES<a class="headerlink" href="#how-to-guides" title="此标题的永久链接">¶</a></h2>
<section id="general-usage">
<h3>General usage<a class="headerlink" href="#general-usage" title="此标题的永久链接">¶</a></h3>
<section id="load">
<h4>Load<a class="headerlink" href="#load" title="此标题的永久链接">¶</a></h4>
<p>Local loading script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;path/to/local/loading_script/loading_script.py&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="c1"># equivalent because the file has the same name as the directory</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;path/to/local/loading_script&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Local and remote files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;my_file.csv&quot;</span><span class="p">)</span>

<span class="n">示例</span><span class="p">:</span> <span class="n">json数据</span>
<span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">}</span>
<span class="n">代码</span><span class="p">:</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;my_file.json&quot;</span><span class="p">)</span>


<span class="n">示例</span><span class="p">:</span> <span class="n">json数据</span>
<span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
 <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">}]</span>
<span class="p">}</span>
<span class="n">代码</span><span class="p">:</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;my_file.json&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>


<span class="n">示例</span><span class="p">:</span> <span class="n">远程</span> <span class="n">JSON</span> <span class="n">文件</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://rajpurkar.github.io/SQuAD-explorer/dataset/&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span>
        <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="n">data_files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;train-v1.json&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">:</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;dev-v1.json&quot;</span><span class="p">},</span>
        <span class="n">field</span><span class="o">=</span><span class="s2">&quot;data&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="process">
<h4>Process<a class="headerlink" href="#process" title="此标题的永久链接">¶</a></h4>
<section id="glue">
<h5>glue数据<a class="headerlink" href="#glue" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;glue&quot;</span><span class="p">,</span> <span class="s2">&quot;mrpc&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort排序</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">sorted_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
<span class="n">sorted_dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">sorted_dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>

<span class="c1"># Shuffle混乱</span>
<span class="n">shuffled_dataset</span> <span class="o">=</span> <span class="n">sorted_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">shuffled_dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>

<span class="n">iterable_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">to_iterable_dataset</span><span class="p">(</span><span class="n">num_shards</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">shuffled_iterable_dataset</span> <span class="o">=</span> <span class="n">iterable_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>


<span class="c1"># Select</span>
<span class="n">small_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">)</span>

<span class="c1"># Filter</span>
<span class="n">start_with_ar</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Ar&quot;</span><span class="p">))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">start_with_ar</span><span class="p">)</span>
<span class="n">start_with_ar</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]</span>

<span class="n">even_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">even_dataset</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Map</span>
<span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;My sentence: &#39;</span> <span class="o">+</span> <span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">example</span>
<span class="n">updated_dataset</span> <span class="o">=</span> <span class="n">small_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">add_prefix</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">updated_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;new_sentence&quot;</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]},</span> <span class="n">remove_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">updated_dataset</span><span class="o">.</span><span class="n">column_names</span>
<span class="p">[</span><span class="s1">&#39;sentence2&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">,</span> <span class="s1">&#39;new_sentence&#39;</span><span class="p">]</span>


<span class="c1"># Split</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">DatasetDict</span><span class="p">({</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentence1&#39;</span><span class="p">,</span> <span class="s1">&#39;sentence2&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">3301</span>
    <span class="p">})</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">({</span>
        <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentence1&#39;</span><span class="p">,</span> <span class="s1">&#39;sentence2&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">],</span>
        <span class="n">num_rows</span><span class="p">:</span> <span class="mi">367</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="c1"># Cast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">features</span>
<span class="p">{</span><span class="s1">&#39;sentence1&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;sentence2&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;not_equivalent&#39;</span><span class="p">,</span> <span class="s1">&#39;equivalent&#39;</span><span class="p">],</span> <span class="n">names_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;idx&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">)}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">ClassLabel</span><span class="p">,</span> <span class="n">Value</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_features</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_features</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_features</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Value</span><span class="p">(</span><span class="s2">&quot;int64&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">new_features</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">features</span>
<span class="p">{</span><span class="s1">&#39;sentence1&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;sentence2&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">],</span> <span class="n">names_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="s1">&#39;idx&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">)}</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">features</span>
<span class="p">{</span><span class="s1">&#39;audio&#39;</span><span class="p">:</span> <span class="n">Audio</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">)}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">16000</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">features</span>
<span class="p">{</span><span class="s1">&#39;audio&#39;</span><span class="p">:</span> <span class="n">Audio</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">)}</span>


<span class="c1"># Rename</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span>
<span class="n">Dataset</span><span class="p">({</span>
    <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentence1&#39;</span><span class="p">,</span> <span class="s1">&#39;sentence2&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">],</span>
    <span class="n">num_rows</span><span class="p">:</span> <span class="mi">3668</span>
<span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span> <span class="s2">&quot;sentenceA&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;sentence2&quot;</span><span class="p">,</span> <span class="s2">&quot;sentenceB&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span>
<span class="n">Dataset</span><span class="p">({</span>
    <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentenceA&#39;</span><span class="p">,</span> <span class="s1">&#39;sentenceB&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">],</span>
    <span class="n">num_rows</span><span class="p">:</span> <span class="mi">3668</span>
<span class="p">})</span>

<span class="c1"># Remove</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span>
<span class="n">Dataset</span><span class="p">({</span>
    <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentence1&#39;</span><span class="p">,</span> <span class="s1">&#39;sentence2&#39;</span><span class="p">,</span> <span class="s1">&#39;idx&#39;</span><span class="p">],</span>
    <span class="n">num_rows</span><span class="p">:</span> <span class="mi">3668</span>
<span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span> <span class="s2">&quot;sentence2&quot;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span>
<span class="n">Dataset</span><span class="p">({</span>
    <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">],</span>
    <span class="n">num_rows</span><span class="p">:</span> <span class="mi">3668</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="imdb">
<h5>imdb数据<a class="headerlink" href="#imdb" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datasets</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imdb&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="go">Dataset({</span>
<span class="go">    features: [&#39;text&#39;, &#39;label&#39;],</span>
<span class="go">    num_rows: 25000</span>
<span class="go">})</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shard</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="n">num_shards</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Dataset</span><span class="p">({</span>
    <span class="n">features</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">],</span>
    <span class="n">num_rows</span><span class="p">:</span> <span class="mi">6250</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="squad">
<h5>SQuAD数据集<a class="headerlink" href="#squad" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;squad&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">features</span>
<span class="go">{&#39;answers&#39;: Sequence(feature={</span>
<span class="go">        &#39;text&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="go">        &#39;answer_start&#39;: Value(dtype=&#39;int32&#39;, id=None)}, length=-1, id=None),</span>
<span class="go">&#39;context&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="go">&#39;id&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="go">&#39;question&#39;: Value(dtype=&#39;string&#39;, id=None),</span>
<span class="go">&#39;title&#39;: Value(dtype=&#39;string&#39;, id=None)}</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flat_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_dataset</span>
<span class="go">Dataset({</span>
<span class="go">    features: [&#39;id&#39;, &#39;title&#39;, &#39;context&#39;, &#39;question&#39;, &#39;answers.text&#39;, &#39;answers.answer_start&#39;],</span>
<span class="go"> num_rows: 87599</span>
<span class="go">})</span>
</pre></div>
</div>
</section>
</section>
<section id="stream">
<h4>Stream<a class="headerlink" href="#stream" title="此标题的永久链接">¶</a></h4>
<figure class="align-default" id="id4">
<img alt="https://img.zhaoweiguo.com/uPic/2023/07/7xFX0b.jpg" src="https://img.zhaoweiguo.com/uPic/2023/07/7xFX0b.jpg" />
<figcaption>
<p><span class="caption-text">数据集流式处理：可以解决使用非常大的数据集，但你没有这么大的磁盘、不想等待、只是想快速浏览几个样本。</span><a class="headerlink" href="#id4" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="o">&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;oscar-corpus/OSCAR-2201&#39;</span><span class="p">,</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">)))</span>
<span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;Founded in 2015, ...&#39;</span><span class="p">,</span> <span class="o">...</span>
</pre></div>
</div>
<p>流式传输数百个压缩 JSONL 文件（如 oscar-corpus/OSCAR-2201）的本地数据集:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="o">&gt;&gt;</span> <span class="n">data_files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="s1">&#39;path/to/OSCAR-2201/compressed/en_meta/*.jsonl.gz&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">data_files</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">)))</span>
<span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;Founded in 2015, ...&#39;</span><span class="p">,</span> <span class="o">...</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shuffle</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;oscar&#39;</span><span class="p">,</span> <span class="s2">&quot;unshuffled_deduplicated_en&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shuffled_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>

<span class="c1"># Split dataset</span>
<span class="n">dataset_head</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>          <span class="c1"># 获取前2个示例</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>      <span class="c1"># 两者配合</span>

<span class="c1"># Interleave</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">interleave_datasets</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">en_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;oscar&#39;</span><span class="p">,</span> <span class="s2">&quot;unshuffled_deduplicated_en&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fr_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;oscar&#39;</span><span class="p">,</span> <span class="s2">&quot;unshuffled_deduplicated_fr&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">multilingual_dataset</span> <span class="o">=</span> <span class="n">interleave_datasets</span><span class="p">([</span><span class="n">en_dataset</span><span class="p">,</span> <span class="n">fr_dataset</span><span class="p">])</span>
</pre></div>
</div>
<p>完整示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForMaskedLM</span><span class="p">,</span> <span class="n">DataCollatorForLanguageModeling</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">with_format</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="n">DataCollatorForLanguageModeling</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">))</span>
<span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForMaskedLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;distilbert-base-uncased&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">set_epoch</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">5</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="audio">
<h3>Audio<a class="headerlink" href="#audio" title="此标题的永久链接">¶</a></h3>
<section id="load-audio-data">
<h4>Load audio data<a class="headerlink" href="#load-audio-data" title="此标题的永久链接">¶</a></h4>
<p>Local files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">audio_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;audio&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path/to/audio_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
        <span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">())</span>
<span class="n">audio_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>AudioFolder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">)</span>
<span class="c1"># OR by specifying the list of files</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;path/to/audio_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>

<span class="c1"># load remote datasets from their URLs</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;https://foo.bar/audio_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="c1"># for example, pass SpeechCommands archive:</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;https://s3.amazonaws.com/test.tar.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="process-audio-data">
<h4>Process audio data<a class="headerlink" href="#process-audio-data" title="此标题的永久链接">¶</a></h4>
<p>Cast:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span> <span class="n">Audio</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;PolyAI/minds14&quot;</span><span class="p">,</span> <span class="s2">&quot;en-US&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">=</span><span class="mi">16000</span><span class="p">))</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="https://img.zhaoweiguo.com/uPic/2023/07/72sLGK.jpg" src="https://img.zhaoweiguo.com/uPic/2023/07/72sLGK.jpg" />
</figure>
<p>Map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">AutoFeatureExtractor</span><span class="p">,</span> <span class="n">AutoProcessor</span>

<span class="n">model_checkpoint</span> <span class="o">=</span> <span class="s2">&quot;facebook/wav2vec2-large-xlsr-53&quot;</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="p">(</span><span class="s2">&quot;./v.json&quot;</span><span class="p">,</span> <span class="n">unk_token</span><span class="o">=</span><span class="s2">&quot;[UNK]&quot;</span><span class="p">,</span> <span class="n">pad_token</span><span class="o">=</span><span class="s2">&quot;[PAD]&quot;</span><span class="p">,</span> <span class="n">word_delimiter_token</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
<span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">AutoFeatureExtractor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_checkpoint</span><span class="p">)</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">AutoProcessor</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">feature_extractor</span><span class="o">=</span><span class="n">feature_extractor</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">prepare_dataset</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span>
    <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;input_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">audio</span><span class="p">[</span><span class="s2">&quot;array&quot;</span><span class="p">],</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="n">audio</span><span class="p">[</span><span class="s2">&quot;sampling_rate&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">input_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;input_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;input_values&quot;</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">processor</span><span class="o">.</span><span class="n">as_target_processor</span><span class="p">():</span>
        <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;sentence&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">input_ids</span>
    <span class="k">return</span> <span class="n">batch</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepare_dataset</span><span class="p">,</span> <span class="n">remove_columns</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-an-audio-dataset">
<h4>Create an audio dataset<a class="headerlink" href="#create-an-audio-dataset" title="此标题的永久链接">¶</a></h4>
<section id="local-files">
<h5>Local files<a class="headerlink" href="#local-files" title="此标题的永久链接">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">audio_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;audio&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path/to/audio_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;audio&quot;</span><span class="p">,</span> <span class="n">Audio</span><span class="p">())</span>
<span class="go"># 查看</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;audio&quot;</span><span class="p">]</span>
<span class="go"># 上传到huggingface hub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">audio_dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;&lt;username&gt;/my_dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>目录:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my_dataset/
├── README.md
└── data/
    └── train-00000-of-00001.parquet
</pre></div>
</div>
</section>
<section id="audiofolder">
<h5>AudioFolder<a class="headerlink" href="#audiofolder" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my_dataset/
├── README.md
├── metadata.csv
├── data/
├───── first_audio_file.mp3
├───── second_audio_file.mp3
└───── third_audio_file.mp3
</pre></div>
</div>
<p>metadata.csv:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span><span class="p">,</span><span class="n">transcription</span>
<span class="n">data</span><span class="o">/</span><span class="n">first_audio_file</span><span class="o">.</span><span class="n">mp3</span><span class="p">,</span><span class="n">znowu</span> <span class="n">się</span> <span class="n">duch</span> <span class="n">z</span> <span class="n">ciałem</span>
<span class="n">data</span><span class="o">/</span><span class="n">second_audio_file</span><span class="o">.</span><span class="n">mp3</span><span class="p">,</span><span class="n">już</span> <span class="n">u</span> <span class="n">źwierzyńca</span> <span class="n">podwojów</span>
<span class="n">data</span><span class="o">/</span><span class="n">third_audio_file</span><span class="o">.</span><span class="n">mp3</span><span class="p">,</span><span class="n">pewnie</span> <span class="n">kędyś</span> <span class="n">w</span> <span class="n">obłędzie</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;audio&#39;:</span>
<span class="go">    {&#39;path&#39;: &#39;/path/to/extracted/audio/first_audio_file.mp3&#39;,</span>
<span class="go">    &#39;array&#39;: array([ 0.00088501,  0.0012207 ,  0.00131226, ..., -0.00045776], dtype=float32),</span>
<span class="go">    &#39;sampling_rate&#39;: 16000},</span>
<span class="go"> &#39;transcription&#39;: &#39;znowu się duch z ciałem&#39;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">electronic</span><span class="o">/</span><span class="mf">01.</span><span class="n">mp3</span>
<span class="n">data</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">punk</span><span class="o">/</span><span class="mf">01.</span><span class="n">mp3</span>

<span class="n">data</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">electronic</span><span class="o">/</span><span class="mf">09.</span><span class="n">mp3</span>
<span class="n">data</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">punk</span><span class="o">/</span><span class="mf">09.</span><span class="n">mp3</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;audiofolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;audio&#39;:</span>
<span class="go">    {&#39;path&#39;: &#39;/path/to/electronic/01.mp3&#39;,</span>
<span class="go">     &#39;array&#39;: array([ 3.9714024e-07,  7.3031038e-07, ..., -1.1244172e-01], dtype=float32),</span>
<span class="go">     &#39;sampling_rate&#39;: 44100},</span>
<span class="go"> &#39;label&#39;: 0  # &quot;electronic&quot;</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">{&#39;audio&#39;:</span>
<span class="go">    {&#39;path&#39;: &#39;/path/to/punk/01.mp3&#39;,</span>
<span class="go">     &#39;array&#39;: array([0.15237972, 0.13222949, ..., 0.33717662], dtype=float32),</span>
<span class="go">     &#39;sampling_rate&#39;: 44100},</span>
<span class="go"> &#39;label&#39;: 1  # &quot;punk&quot;</span>
<span class="go">}</span>
</pre></div>
</div>
</section>
<section id="loading-script">
<h5>Loading script<a class="headerlink" href="#loading-script" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my_dataset/
├── README.md
├── my_dataset.py
└── data/
    ├── train.tar.gz
    ├── test.tar.gz
    └── metadata.csv
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;path/to/my_dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="vision">
<h3>Vision<a class="headerlink" href="#vision" title="此标题的永久链接">¶</a></h3>
<section id="load-image-data">
<h4>Load image data<a class="headerlink" href="#load-image-data" title="此标题的永久链接">¶</a></h4>
<p>load:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span> <span class="n">Image</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;beans&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Local files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path/to/image_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">Image</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
<span class="go">&lt;PIL.PngImagePlugin.PngImageFile image mode=RGBA size=1200x215 at 0x15E6D7160&gt;]</span>


<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;beans&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">Image</span><span class="p">(</span><span class="n">decode</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
</pre></div>
</div>
<section id="imagefolder">
<h5>ImageFolder<a class="headerlink" href="#imagefolder" title="此标题的永久链接">¶</a></h5>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">dog</span><span class="o">/</span><span class="n">golden_retriever</span><span class="o">.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">dog</span><span class="o">/</span><span class="n">german_shepherd</span><span class="o">.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">dog</span><span class="o">/</span><span class="n">chihuahua</span><span class="o">.</span><span class="n">png</span>

<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">cat</span><span class="o">/</span><span class="n">maine_coon</span><span class="o">.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">cat</span><span class="o">/</span><span class="n">bengal</span><span class="o">.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">cat</span><span class="o">/</span><span class="n">birman</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imagefolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&quot;image&quot;: &lt;PIL.PngImagePlugin.PngImageFile image mode=RGBA size=1200x215 at 0x15E6D7160&gt;, &quot;label&quot;: 0}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">{&quot;image&quot;: &lt;PIL.PngImagePlugin.PngImageFile image mode=RGBA size=1200x215 at 0x15E8DAD30&gt;, &quot;label&quot;: 1}</span>
</pre></div>
</div>
<p>Load remote datasets from their URLs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imagefolder&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;https://a.cn/name.zip&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="process-image-data">
<h4>Process image data<a class="headerlink" href="#process-image-data" title="此标题的永久链接">¶</a></h4>
<section id="map">
<h5>Map<a class="headerlink" href="#map" title="此标题的永久链接">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">transforms</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;pixel_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]]</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">examples</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">transforms</span><span class="p">,</span> <span class="n">remove_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;label&#39;: 6,</span>
<span class="go"> &#39;pixel_values&#39;: &lt;PIL.PngImagePlugin.PngImageFile image mode=RGB size=100x100 at 0x7F058237BB10&gt;}</span>
</pre></div>
</div>
</section>
<section id="apply-transforms">
<h5>Apply transforms<a class="headerlink" href="#apply-transforms" title="此标题的永久链接">¶</a></h5>
<ul class="simple">
<li><p>data augmentation libraries</p></li>
<li><p>torchvision: <a class="reference external" href="https://pytorch.org/vision/stable/index.html">https://pytorch.org/vision/stable/index.html</a></p></li>
<li><p>Albumentations: <a class="reference external" href="https://imgaug.readthedocs.io/en/latest/">https://imgaug.readthedocs.io/en/latest/</a></p></li>
<li><p>Kornia: <a class="reference external" href="https://albumentations.ai/docs/">https://albumentations.ai/docs/</a></p></li>
<li><p>imgaug: <a class="reference external" href="https://kornia.readthedocs.io/en/latest/">https://kornia.readthedocs.io/en/latest/</a></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">Compose</span><span class="p">,</span> <span class="n">ColorJitter</span><span class="p">,</span> <span class="n">ToTensor</span>
<span class="n">jitter</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span>
         <span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
         <span class="n">ToTensor</span><span class="p">(),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">transforms</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
    <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;pixel_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">jitter</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">examples</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="create-an-image-dataset">
<h4>Create an image dataset<a class="headerlink" href="#create-an-image-dataset" title="此标题的永久链接">¶</a></h4>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">csv</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="mf">0001.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="mf">0002.</span><span class="n">png</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="mf">0003.</span><span class="n">png</span>
</pre></div>
</div>
<p>压缩版示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">folder</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">csv</span>
<span class="n">folder</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">zip</span>
<span class="n">folder</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">zip</span>
<span class="n">folder</span><span class="o">/</span><span class="n">valid</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">metadata.csv</span></code> 文件内容:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span><span class="p">,</span><span class="n">additional_feature</span>
<span class="mf">0001.</span><span class="n">png</span><span class="p">,</span><span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">first</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="n">text</span> <span class="n">feature</span> <span class="n">you</span> <span class="n">added</span> <span class="n">to</span> <span class="n">your</span> <span class="n">images</span>
<span class="mf">0002.</span><span class="n">png</span><span class="p">,</span><span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">second</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="n">text</span> <span class="n">feature</span> <span class="n">you</span> <span class="n">added</span> <span class="n">to</span> <span class="n">your</span> <span class="n">images</span>
<span class="mf">0003.</span><span class="n">png</span><span class="p">,</span><span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">third</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="n">text</span> <span class="n">feature</span> <span class="n">you</span> <span class="n">added</span> <span class="n">to</span> <span class="n">your</span> <span class="n">images</span>
</pre></div>
</div>
<p>or using <code class="docutils literal notranslate"><span class="pre">metadata.jsonl</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;0001.png&quot;</span><span class="p">,</span> <span class="s2">&quot;additional_feature&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a first value of a text feature you added to your images&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;0002.png&quot;</span><span class="p">,</span> <span class="s2">&quot;additional_feature&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a second value of a text feature you added to your images&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;0003.png&quot;</span><span class="p">,</span> <span class="s2">&quot;additional_feature&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a third value of a text feature you added to your images&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>示例-metadata.csv:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span><span class="p">,</span><span class="n">text</span>
<span class="mf">0001.</span><span class="n">png</span><span class="p">,</span><span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">golden</span> <span class="n">retriever</span> <span class="n">playing</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ball</span>
<span class="mf">0002.</span><span class="n">png</span><span class="p">,</span><span class="n">A</span> <span class="n">german</span> <span class="n">shepherd</span>
<span class="mf">0003.</span><span class="n">png</span><span class="p">,</span><span class="n">One</span> <span class="n">chihuahua</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imagefolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
<span class="go">&quot;This is a golden retriever playing with a ball&quot;</span>
</pre></div>
</div>
<p>Upload dataset to the Hub:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imagefolder&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/folder&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s2">&quot;stevhliu/my-image-captioning-dataset&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="depth-estimation">
<h4>Depth estimation<a class="headerlink" href="#depth-estimation" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;sayakpaul/nyu_depth_v2&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="image-classification">
<h4>Image classification<a class="headerlink" href="#image-classification" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;beans&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="semantic-segmentation">
<h4>Semantic segmentation<a class="headerlink" href="#semantic-segmentation" title="此标题的永久链接">¶</a></h4>
<p>安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">albumentations</span>
</pre></div>
</div>
<p>使用示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;sayakpaul/nyu_depth_v2&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="object-detection">
<h4>Object detection<a class="headerlink" href="#object-detection" title="此标题的永久链接">¶</a></h4>
<p>安装:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">albumentations</span> <span class="n">opencv</span><span class="o">-</span><span class="n">python</span>
</pre></div>
</div>
<p>使用示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;cppe-5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="text">
<h3>Text<a class="headerlink" href="#text" title="此标题的永久链接">¶</a></h3>
<section id="load-text-data">
<h4>Load text data<a class="headerlink" href="#load-text-data" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">data_files</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;my_text_1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;my_text_2.txt&quot;</span><span class="p">],</span>
                <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;my_test_file.txt&quot;</span>
        <span class="p">}</span>
<span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;path/to/text/dataset&quot;</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">data_files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;my_train_file.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;my_test_file.txt&quot;</span><span class="p">},</span>
        <span class="n">sample_by</span><span class="o">=</span><span class="s2">&quot;paragraph&quot;</span>
<span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">data_files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="s2">&quot;my_train_file.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;my_test_file.txt&quot;</span><span class="p">},</span>
        <span class="n">sample_by</span><span class="o">=</span><span class="s2">&quot;document&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>示例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">c4_subset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;allenai/c4&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;en/c4-train.0000*-of-01024.json.gz&quot;</span><span class="p">)</span>


<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;https://huggingface.co/datasets/lhoestq/test/resolve/main/some_text.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="process-text-data">
<h4>Process text data<a class="headerlink" href="#process-text-data" title="此标题的永久链接">¶</a></h4>
<p>Map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">examples</span><span class="p">:</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]),</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;the rock is destined to be the 21st century...&#39;</span><span class="p">,</span>
 <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;input_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">1996</span><span class="p">,</span> <span class="mi">2600</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">16036</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
 <span class="s1">&#39;token_type_ids&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
 <span class="s1">&#39;attention_mask&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]}</span>
</pre></div>
</div>
</section>
</section>
<section id="tabular">
<h3>Tabular<a class="headerlink" href="#tabular" title="此标题的永久链接">¶</a></h3>
<section id="csv-files">
<h4>CSV files<a class="headerlink" href="#csv-files" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="s2">&quot;my_file.csv&quot;</span><span class="p">)</span>

<span class="c1"># load multiple CSV files</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my_file_1.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;my_file_2.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;my_file_3.csv&quot;</span><span class="p">])</span>

<span class="c1"># 训练集、测试集拆分</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;my_train_file_1.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;my_train_file_2.csv&quot;</span><span class="p">],</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;my_test_file.csv&quot;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pandas-dataframes">
<h4>Pandas DataFrames<a class="headerlink" href="#pandas-dataframes" title="此标题的永久链接">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://huggingface.co/datasets/imodels/credit-card/raw/main/train.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="databases">
<h4>Databases<a class="headerlink" href="#databases" title="此标题的永久链接">¶</a></h4>
<section id="sqlite">
<h5>SQLite<a class="headerlink" href="#sqlite" title="此标题的永久链接">¶</a></h5>
<p>创建数据库:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;us_covid_data.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>load:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;sqlite:///us_covid_data.db&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_sql</span><span class="p">(</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>
<span class="c1"># ds = Dataset.from_sql(&#39;SELECT * FROM states WHERE state=&quot;California&quot;;&#39;, uri)</span>
<span class="n">ds</span>
</pre></div>
</div>
<p>使用:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;California&quot;</span><span class="p">)</span>
<span class="c1"># ds.filter(lambda x: x[&quot;cases&quot;] &gt; 10000)</span>
</pre></div>
</div>
</section>
<section id="postgresql">
<h5>PostgreSQL<a class="headerlink" href="#postgresql" title="此标题的永久链接">¶</a></h5>
<ul class="simple">
<li><p>参考: <a class="reference external" href="https://huggingface.co/docs/datasets/v2.13.1/en/package_reference/main_classes#datasets.Dataset.from_sql">https://huggingface.co/docs/datasets/v2.13.1/en/package_reference/main_classes#datasets.Dataset.from_sql</a></p></li>
</ul>
</section>
</section>
</section>
<section id="dataset-repository">
<h3>Dataset repository<a class="headerlink" href="#dataset-repository" title="此标题的永久链接">¶</a></h3>
<section id="share">
<h4>Share<a class="headerlink" href="#share" title="此标题的永久链接">¶</a></h4>
<p>create</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ huggingface-cli repo create your_dataset_name --type dataset
</pre></div>
</div>
<p>clone:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make sure you have git-lfs installed</span>
<span class="c1"># (https://git-lfs.github.com/)</span>
<span class="n">git</span> <span class="n">lfs</span> <span class="n">install</span>

<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">huggingface</span><span class="o">.</span><span class="n">co</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="n">namespace</span><span class="o">/</span><span class="n">your_dataset_name</span>
</pre></div>
</div>
<ul class="simple">
<li><p>剩下的和普通的git差不多操作…</p></li>
</ul>
</section>
<section id="create-a-dataset-loading-script">
<h4>Create a dataset loading script<a class="headerlink" href="#create-a-dataset-loading-script" title="此标题的永久链接">¶</a></h4>
<p>A dataset loading script should have the same name as a dataset repository or directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my_dataset/
├── README.md
└── my_dataset.py
</pre></div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Transformers.html" class="btn btn-neutral float-right" title="3.2.5. Transformers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lib_python.html" class="btn btn-neutral" title="3.2.3. Hub Python Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  <div id="gitalk-container"></div>
  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2024, 新溪-gordon.

    </p>
  </div>
  <div>备案号 <a href="http://www.beian.miit.gov.cn">京ICP备16018553号</a></div><div>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a></div>. 


</footer>

<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?042289284b8eb33866001347a3e0b129";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>     
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'V1.7.9',
            LANGUAGE:'zh-CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../../_static/copybutton.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });


      var gitalk = new Gitalk({
              clientID: '565177626b5d46427009',
              clientSecret: 'b2a36e67e1d2a73e43667f46d571c2624f8e1026',
              repo: 'knowledge',
              owner: 'zhaoweiguo',
              admin: ['zhaoweiguo'],
              id: location.pathname,      // Ensure uniqueness and length less than 50
              distractionFreeMode: false  // Facebook-like distraction free mode
            })
      gitalk.render('gitalk-container')

  </script>


<script type="text/javascript" src="../../_static/js/table-of-contents-sidebar.js"></script>
<!-- <script type="text/javascript" src="https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/table-of-contents-sidebar.js"></script> -->
<script type="text/javascript">
    window.onload = function(e){
        TableOfContents.init({
            basePath: "https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/",
            querySelector: "body" // or other css querySelector
        });
    }
</script> 

</body>
</html>