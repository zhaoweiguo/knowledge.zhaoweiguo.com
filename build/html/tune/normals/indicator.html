

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>


<!-- start added 2025-04-14   增加对markdown中公式的支持 -->
<script>
window.MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true
    },
    options: {
        ignoreHtmlClass: "tex2jax_ignore|mathjax_ignore",
        processHtmlClass: "tex2jax_process|mathjax_process|math|output_area"
    }
};
</script>
<script defer="defer" src="https://fastly.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- end added 2025-04-14   增加对markdown中公式的支持 -->


<!-- start added 2025-08-06   增加对mermaid图的支持 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        flowchart: { useMaxWidth: true }
    });
});
</script>
<!--  end added 2025-08-06   增加对mermaid图的支持 -->




  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>常见指标 &mdash; 新溪-gordon V2025.08 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="常用" href="normal.html" />
    <link rel="prev" title="常用" href="../normal.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/jquery.min.js"></script>


<!-- 评论插件 gittalk start -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> -->
<!-- 评论插件 gittalk end -->


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> 新溪-gordon
          

          
          </a>

          
            
            
              <div class="version">
                V2025.08
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">性能&amp;调优</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../normal.html">常用</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">常见指标</a></li>
<li class="toctree-l2"><a class="reference internal" href="normal.html">常用</a></li>
<li class="toctree-l2"><a class="reference internal" href="GPU.html">GPU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="GPUs/normal.html">通用</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPUs/calc_param.html">模型参数计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPUs/calc_TOPS.html">TOPS计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="GPUs/calc_VRAM.html">GPU显存计算</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="HTTP.html">HTTP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sla.html">SLA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stress_testing.html">压力测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stress_testings/normal.html">常用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stress_testings/normals/normal.html">常用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stress_testings/normals/concept.html">压测定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stress_testings/normals/qps.html">QPS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../system.html">系统级别优化相关</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../systems/tune_file.html">性能相关</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/tune_tool.html">优化工具</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../systems/tools/SystemTap.html">SystemTap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../systems/tune_tmp.html">优化相关临时</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tool.html">工具</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/simple.html">简单工具</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/webbench.html">webbench的使用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/ab.html">Apache Bench(ab)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/http_load.html">http_load命令使用方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/siege.html">siege命令的使用方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/locust.html">Locust</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/wrk.html">wrk命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/hey.html">hey 命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/ali.html">ali</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/simples/ali.html#vegeta">vegeta</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/tsung.html">Tsung使用文档</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_introduce.html">简单介绍</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_usage.html">简单用法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_advance.html">高级配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_config.html">tsung参考文档说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_report.html">tsung参考文档——报告图表含义说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_practice.html">Tsung压测实践</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung-1.0-dtd.html">tsung-1.0.dtd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_question.html">常见问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/tsungs/tsung_other.html">其他压测工具</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/jmeter.html">Apache JMeter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/loadRunner.html">LoadRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/TCPBurn.html">TCPBurn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/cloudPlatform.html">云平台</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/other.html">其他</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/others/k6.html">k6</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observe.html">性能观察</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observes/cpu.html">CPU&amp;内存使用情况查看</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">新溪-gordon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../normal.html">常用</a> &raquo;</li>
        
      <li>常见指标</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/normals/indicator.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            <nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
              <h4 id="local-table-of-contents-title">On This Page</h4>
              <ul>
<li><a class="reference internal" href="#">常见指标</a><ul>
<li><a class="reference internal" href="#id3">响应指标</a><ul>
<li><a class="reference internal" href="#id4">常见响应指标</a></li>
<li><a class="reference internal" href="#id5">用户体验</a></li>
<li><a class="reference internal" href="#id6">操作系统</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">并发指标</a><ul>
<li><a class="reference internal" href="#id8">常见并发指标</a></li>
<li><a class="reference internal" href="#id9">服务器</a></li>
<li><a class="reference internal" href="#java">Java</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">内存, 磁盘指标</a><ul>
<li><a class="reference internal" href="#id11">磁盘</a></li>
<li><a class="reference internal" href="#id12">传输速度</a></li>
<li><a class="reference internal" href="#pv-qps">pv/qps 计算</a></li>
<li><a class="reference internal" href="#id13">可靠性</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tmp">tmp</a><ul>
<li><a class="reference internal" href="#unix">UNIX 网络编程</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">参考</a></li>
</ul>
</li>
</ul>

            </nav>
  <table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
<section id="id2">
<h1>常见指标<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h1>
<p>单位:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="n">ns</span>                 <span class="n">纳秒</span><span class="p">(</span><span class="n">nano</span> <span class="n">second</span><span class="p">)</span>
<span class="mi">1</span><span class="n">us</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="n">ns</span>       <span class="n">微秒</span><span class="p">(</span><span class="n">micro</span> <span class="n">second</span><span class="p">)</span>
<span class="mi">1</span><span class="n">ms</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="n">us</span>       <span class="n">毫秒</span><span class="p">(</span><span class="n">milli</span> <span class="n">second</span><span class="p">)</span>
<span class="mi">1</span><span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="n">ms</span>        <span class="n">秒</span>
</pre></div>
</div>
<section id="id3">
<h2>响应指标<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<section id="id4">
<h3>常见响应指标<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h3>
<figure class="align-default" id="id16">
<img alt="https://img.zhaoweiguo.com/knowledge/images/cores/tunes/indicator1.png" src="https://img.zhaoweiguo.com/knowledge/images/cores/tunes/indicator1.png" />
<figcaption>
<p><span class="caption-text">每个程序员都应该知道的延迟数字</span><a class="headerlink" href="#id16" title="此图像的永久链接">¶</a></p>
</figcaption>
</figure>
<p>《Teach Yourself Programming in Ten Years》:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. fetch from L1 cache memory(从一级缓存中读取数据):
0.5 nanosec

2. branch misprediction(分支预测失败):
5 nanosec

3. fetch from L2 cache memory(从二级缓存获取数据):
7 nanosec

4. Mutex lock/unlock(互斥加锁 / 解锁):
25 nanosec

5. fetch from main memory(从主内存获取数据):
100 nanosec

6. send 2K bytes over 1Gbps network(通过 1G bps 的网络发送 2K 字节):
20,000 nanosec = 20us(微秒)

7. read 1MB sequentially from memory(从内存中顺序读取 1MB 数据):
250,000 nanosec = 250us

8. fetch from new disk location (seek)(从新的磁盘位置获取数据（寻道）):
8,000,000 nanosec = 8ms(毫秒)

9. read 1MB sequentially from disk(从磁盘中顺序读取 1MB 数据):
20,000,000 nanosec =20ms

10. send packet US to Europe and back(从美国发送一个报文包到欧洲再返回):
150 milliseconds = 150,000,000 nanosec
</pre></div>
</div>
</section>
<section id="id5">
<h3>用户体验<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>交互响应时间 超过 100~200ms 就被认为是不好的</p></li>
<li><p>用户体验来说:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 0~200ms，用户无感知
2. 200ms~1s，稍感延迟，可接受
3. 1~Ns，明显等待，越长体验越差
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id6">
<h3>操作系统<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h3>
<p>按页读取:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>一页大小通常是 4KB，这个值可以通过 getconfig PAGE_SIZE 命令查看
一次会读一页的数据。如果要读取的数据量超过一页的大小，就会触发多次 IO 操作
我们在选择 m 大小的时候，要尽量让每个节点的大小等于一个页的大小。读取一个节点，只需要一次磁盘 IO 操作。
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">高速缓存的读取时间可能是</span> <span class="mf">0.5</span><span class="n">ns</span>
<span class="n">而内存的访问时间可能是</span> <span class="mi">50</span><span class="n">ns</span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h2>并发指标<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h2>
<section id="id8">
<h3>常见并发指标<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>redis: 并发请求数也就每秒 3-5 万(基于 Reactor 模式)</p></li>
<li><p>nginx 负载均衡性能是 3-5 万左右(基于 Reactor 模式)</p></li>
<li><p>mc 的读取性能 3-5 万左右(基于 Reactor 模式)</p></li>
<li><p>LVS 的性能是十万级，据说可达到 80 万 / 秒</p></li>
<li><p>F5 性能是百万级，从 200 万 / 秒到 800 万 / 秒都有</p></li>
<li><p>kafka 号称百万级, 百万级是集群性能</p></li>
<li><p>zookeeper 写入读取 2 万以上</p></li>
<li><p>http 请求访问大概在 1.5-2 万左右(HTTP get 操作访问一个简单页面测试结果)</p></li>
<li><p>MySQL 的 TPS 和写入的数据有关:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>写入 k/v 数据，主键存储 key，上万TPS
读取 k/v 数据，可以达到10万 QPS

mysql 官网 benchmarks:
https://www.mysql.com/why-mysql/benchmarks/
单机 32users 并发只读近 40w+ qps，读写 10w+ qps
说明:
    这个数据有误导性，要看具体的 SQL 语句和表结构，实际应用中一般不可能这么高
    这个数据是简单的 k/v 数据
</pre></div>
</div>
</li>
<li><p>NoSQL量级一般都是上万，但和测试硬件测试用例相关</p></li>
<li><p>业务系统一个 TPS 接口的请求时间 10~50ms 是比较合理的，QPS 5~20ms 是比较合理的</p></li>
</ul>
<p>理想情况下，性能测试的时候，CPU 能压到 80% 以上，此时的 TPS/QPS 就是峰值，如果 CPU 没压满，指标就上不去，就可能有优化的空间。
如果是业务系统，由于业务复杂度差异很大，有的每秒 500 请求可能就是高性能了，因此需要针对业务进行性能测试，确立性能基线，方便后续架构设计做比较</p>
<p>http 相关性能:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Spring Boot 基于 HTTP 协议的，HTTP 协议本身的解析非常耗性能
    我们之前实测 Hello world，16 核或者 32 核的机器，单机 TPS 也就 1.5 万左右（核数增加对性能作用不大）
</pre></div>
</div>
<ul>
<li><p>一般把日活转换为 pv，然后按 pv 计算 QPS</p></li>
<li><p>单台服务器性能一般是:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>企业用的线上物理服务器，如:
16 核 16g
32 核 16G
与时俱进，现在基本都是 32 核 48g 内存

云主机的性能可以按照同配置的物理机 80% 的性能来估算
</pre></div>
</div>
</li>
</ul>
</section>
<section id="id9">
<h3>服务器<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>一台机器最多开65535个 port, 其中压测可用的 port 是 <code class="docutils literal notranslate"><span class="pre">32768～65535</span></code> ,也就是每个兵团的士兵可达到 <code class="docutils literal notranslate"><span class="pre">32768</span></code> 个</p></li>
<li><p>单机可以支持: C100K, C1000K, C1M, C10M, C20M</p></li>
<li><p>单进程文件句柄最大可以设置:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>即: 单个进程可分配的最大文件数
在我们使用ulimit或limits.conf来设置时，如果要超过默认的1048576值时需要先增大nr_open值


注: Linux 内核 2.6.25 以前，在内核里面宏定义是 1024*1024，最大只能是 100w（1048576）
如果 Linux 内核大于 2.6.25 则可以设置更大值
</pre></div>
</div>
</li>
</ul>
</section>
<section id="java">
<h3>Java<a class="headerlink" href="#java" title="此标题的永久链接">¶</a></h3>
<p>经过 Netty 封装相比Java 原生 NIO，大约有 10% 的性能损耗:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>在 1K 大小报文时
原生的 Java NIO 在当时的测试环境所能达到 TPS（每秒事务数） 的极限大约 5 万出头，
而 Netty 在 4.5 万附近
增加了 RPC 的编解码后，TPS 极限下降至 1.3 万左右
加上不算简单的业务逻辑，能预期的单实例真实 TPS 也许只有 1 千 ～2 千


注: 极限，就是继续加压，但 TPS 不再上升，CPU 也消耗不上去，延时却在增加
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h2>内存, 磁盘指标<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>一个TCP套接字连接占用的内存做分析，大概占4KByte</p></li>
</ul>
<p>内存:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">单根</span> <span class="n">DDR4</span> <span class="n">内存的数据传输带宽最高为</span> <span class="mi">34</span><span class="n">GB</span><span class="o">/</span><span class="n">s</span>
    <span class="n">工作频率最高可达</span> <span class="mi">4266</span><span class="n">MHz</span>
</pre></div>
</div>
<p>以 PC 为例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Intel</span> <span class="mi">386</span> <span class="n">时代服务器存储能力只有几百</span> <span class="n">MB</span>
<span class="n">Intel</span> <span class="n">奔腾时代服务器存储能力可以有几十</span> <span class="n">GB</span>
<span class="n">Intel</span> <span class="n">酷睿多核时代的服务器可以有几个</span> <span class="n">TB</span>
</pre></div>
</div>
<p>估算一下，给这 1 亿张图片构建散列表大约需要多少台机器:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 假设我们通过 MD5 来计算哈希值，那长度就是 128 比特，也就是 16 字节
2. 文件路径长度的上限是 256 字节，我们可以假设平均长度是 128 字节
3. 如果我们用链表法来解决冲突，那还需要存储指针，指针占用 8 字节
所以，散列表中每个数据单元就占用 152 字节（这里只是估算，并不准确）

假设一台机器的内存大小为 2GB，散列表的装载因子为 0.75，
那一台机器可以给大约 1000 万（2GB*0.75/152）张图片构建散列表
所以，如果要对 1 亿张图片构建索引，需要大约十几台机器。
在工程中，这种估算还是很重要的，
能让我们事先对需要投入的资源、资金有个大概的了解，能更好地评估解决方案的可行性。
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>内存的访问速度是纳秒级别的
磁盘访问的速度是毫秒级别的
从内存中读取所花费时间的上万倍，甚至几十万倍
</pre></div>
</div>
<section id="id11">
<h3>磁盘<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h3>
<figure class="align-default">
<img alt="https://img.zhaoweiguo.com/uPic/2023/10/EGdEN9.png" src="https://img.zhaoweiguo.com/uPic/2023/10/EGdEN9.png" />
</figure>
<p>说明:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PCI Express主要用于连接高速设备，如显卡、声卡等
    使用点对点串行连接，每个设备都有自己的专用连接，不需要向整个总线请求带宽，而且可以把数据传输率提高到一个很高的频率，达到PCI所不能提供的高带宽。
SATA 3.0则主要用于连接存储设备，如硬盘和光驱
</pre></div>
</div>
<p>SATA 3.0 的接口:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">带宽是</span> <span class="mi">6</span><span class="n">Gb</span><span class="o">/</span><span class="n">s</span><span class="p">(</span><span class="n">转Byte</span><span class="o">=</span><span class="mi">768</span><span class="n">MB</span><span class="p">)</span>
</pre></div>
</div>
<p>PCI Express 的接口:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>在读取的时候就能做到 2GB/s 左右，差不多是 HDD 硬盘的 10 倍
在写入的时候也能有 1.2GB/s

IOPS 也就是在 2 万左右
</pre></div>
</div>
<p>HDD 硬盘(机械硬盘):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  5400转笔记本硬盘平均读写速度大致在60-90MB这个区间
  7200转台式机硬盘大致在130-190MB区间
  10000转和15000转台式机硬盘数据不详


数据传输率，差不多在 200MB/s 以内
IOPS 通常在 100 左右

随机读取磁盘上某一个 4KB 大小的数据:
  在随机读写的时候，数据传输率也只能到 40MB/s 左右，是顺序读写情况下的几十分之一
</pre></div>
</div>
<p>响应时间指标:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SSD</span> <span class="n">硬盘</span><span class="p">:</span> <span class="n">几十微秒</span>
<span class="n">HDD</span> <span class="n">硬盘</span><span class="p">:</span> <span class="n">几毫秒到十几毫秒</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>传输速度<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h3>
<ul>
<li><p>线路传输的速度是毫秒级别:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 同一机房: 内部能够做到几毫秒；
2. 同城异地: 几毫秒~十几毫秒(距离上一般大约就是几十千米)
3. 跨城异地: 几十甚至上百毫秒(几百、上千千米)
    例如:
    从广州机房到北京机房，稳定情况下 ping 延时大约是 50ms，不稳定情况下可能达到 1s 甚至更多
4. 跨国异地: 几秒钟
</pre></div>
</div>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>光速真空传播大约是每秒 30 万千米
在光纤中传输的速度大约是每秒 20 万千米

光速：C = 30 万千米 / 秒
光纤：V = C/1.5=20 万千米 / 秒

网速:
    2017 年 11 月知名测速网站 Ookla 发布报告，全国平均上网带宽达到 61.24 Mbps，
    千兆带宽下 10KB 数据的极限 QPS 为 1.25 万 QPS=1000Mbps/8/10KB

实例1:
北京到广州距离为2100多公里，即: 理想情况下，光纤在北京到广州传输需要0.21/20=0.01s=10ms
    但传输中的各种网络设备的处理，实际还远远达不到理论上的速度
    一般从广州机房到北京机房，稳定情况下 延时大约是 50ms

实例2:
地球到火星距离是 0.55~4 亿千米。近距离约为 5500 万公里，最远距离则超过 4 亿公里。
    2021 年 5 月 15 日祝融号登陆的 9 分钟被称作 “恐怖 9 分钟，因为这9分钟我们是不可能操控探测器的。
    原因是地球在与火星通讯的时候会有十几二十分钟的延迟。
    这十几分钟延迟算法如下：
        按光在真空中最快的30万km/s，距离5500-40000万km延时分别为:
        5500/30 ~ 40000/30 = 183s ~ 1333s = 3分钟~22分钟
        这是最理想的速度的延时。
</pre></div>
</div>
</section>
<section id="pv-qps">
<h3>pv/qps 计算<a class="headerlink" href="#pv-qps" title="此标题的永久链接">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pv</span> <span class="o">=</span> <span class="n">日活</span> <span class="o">*</span> <span class="n">人均点击次数</span>
<span class="n">并发均值</span> <span class="o">=</span> <span class="n">pv</span><span class="o">/</span><span class="mi">86400</span>
<span class="n">并发峰值</span> <span class="o">=</span> <span class="n">并发均值</span> <span class="o">*</span> <span class="n">N</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 响应时间（RT）
2. 并发数（Concurrency）
3. 吞吐量（TPS）

吞吐量 = 并发数 / 平均响应时间
</pre></div>
</div>
<ul class="simple">
<li><p>最⼤吞吐量： 可⽀持的带宽</p></li>
<li><p>最⼤并发连接数: 每秒连接的总数量，体现并发处理连接的能⼒</p></li>
<li><p>CPS: 每秒新建连接数：每秒新建连接的数量，体现处理新增连接的能⼒</p></li>
<li><p>PPS: 每秒处理包量: 每秒钟转发的包量，体现包转发速率</p></li>
<li><p>QPS: Query Per Second(每秒请求数，一般指读取，TPS)</p></li>
<li><p>TPS: Transactions Per Second(每秒事务数，一般指写入，QPS)</p></li>
<li><p>并发数：同一时刻的接收的访问数量，时间单位一般用秒，也可以用分钟和小时，常见有并发请求数，并发连接数</p></li>
<li><p>日活：每日活跃用户数，指当天来访问过系统的用户，同一用户，无论用户访问多少功能和页面都只算一个用户</p></li>
</ul>
</section>
<section id="id13">
<h3>可靠性<a class="headerlink" href="#id13" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>单机的可靠性大概是 100 天丢失一次数据，数据修复时间是 1 天（即可靠性是 2 个 9）</p></li>
<li><p>单机可靠性只有两个 9 不是算出来的，统计出来的</p></li>
</ul>
</section>
</section>
<section id="tmp">
<h2>tmp<a class="headerlink" href="#tmp" title="此标题的永久链接">¶</a></h2>
<section id="unix">
<h3>UNIX 网络编程<a class="headerlink" href="#unix" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>RTT在一个局域网上大约是几毫秒，跨越一个广域网则可能是数秒钟</p></li>
</ul>
</section>
</section>
<section id="id14">
<h2>参考<a class="headerlink" href="#id14" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>伯克利大学的一个动态网页可以查看每年计算机中各类操作耗时、延迟的变化: <a class="reference external" href="https://colin-scott.github.io/personal_website/research/interactive_latency.html">https://colin-scott.github.io/personal_website/research/interactive_latency.html</a></p></li>
</ul>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="/index.html">主页</a></p></td>
<td><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">索引</span></a></p></td>
<td><p><a class="reference internal" href="../py-modindex.html"><span class="std std-ref">模块索引</span></a></p></td>
<td><p><a class="reference internal" href="../search.html"><span class="std std-ref">搜索页面</span></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="normal.html" class="btn btn-neutral float-right" title="常用" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../normal.html" class="btn btn-neutral" title="常用" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  
  <div id="gitalk-container"></div>
  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2025, 新溪-gordon.

    </p>
  </div>
  <div>备案号 <a href="http://www.beian.miit.gov.cn">京ICP备16018553号</a></div><div>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a></div>. 


</footer>

<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?042289284b8eb33866001347a3e0b129";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>     
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'V2025.08',
            LANGUAGE:'zh-CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../_static/clipboard.min.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });


      // var gitalk = new Gitalk({
      //         clientID: '565177626b5d46427009',
      //         clientSecret: 'b2a36e67e1d2a73e43667f46d571c2624f8e1026',
      //         repo: 'knowledge',
      //         owner: 'zhaoweiguo',
      //         admin: ['zhaoweiguo'],
      //         id: location.pathname,      // Ensure uniqueness and length less than 50
      //         distractionFreeMode: false  // Facebook-like distraction free mode
      //       })
      // gitalk.render('gitalk-container')

  </script>


<script type="text/javascript" src="../_static/js/table-of-contents-sidebar.js"></script>
<!-- <script type="text/javascript" src="https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/table-of-contents-sidebar.js"></script> -->
<script type="text/javascript">
    window.onload = function(e){
        TableOfContents.init({
            basePath: "https://table-of-contents-sidebar.github.io/table-of-contents-sidebar-lib/",
            querySelector: "body" // or other css querySelector
        });
    }
</script> 

</body>
</html>