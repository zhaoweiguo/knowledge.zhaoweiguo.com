å‰å‘/åå‘ä¼ æ’­
#############

* â€œæ­£å‘ä¼ æ’­â€æ±‚æŸå¤±ï¼Œâ€œåå‘ä¼ æ’­â€å›ä¼ è¯¯å·®
* ç¥ç»ç½‘ç»œæ¯å±‚çš„æ¯ä¸ªç¥ç»å…ƒéƒ½å¯ä»¥æ ¹æ®è¯¯å·®ä¿¡å·ä¿®æ­£æ¯å±‚çš„æƒé‡


ç¥ç»å…ƒ
======

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/lh50CD.png

    M-P(éº¦å¡æ´›å…‹-çš®èŒ¨, McCulloch-Pitts)ç¥ç»å…ƒæ¨¡å‹ï¼Œå®ƒæ˜¯æ„ŸçŸ¥æœºçš„åŸºç¡€æ¨¡å‹ã€‚M-Pç¥ç»å…ƒæ˜¯ä¸€ç§äºŒå…ƒåˆ†ç±»æ¨¡å‹ï¼Œå°†åŠ æƒæ±‚å’Œçš„ç»“æœè¾“å…¥åˆ°æ¿€æ´»å‡½æ•°ä¸­ï¼Œåˆ¤æ–­è¾“å‡ºæ˜¯0æˆ–1ã€‚ç¥ç»å…ƒçš„è¾“å‡º: :math:`y=\textstyle\mathrm{f}( \sum_{i=1}^n w_i x_i - \theta)`.å…¶ä¸­ ``Î¸`` ä¸ºæˆ‘ä»¬ä¹‹å‰æåˆ°çš„ç¥ç»å…ƒçš„æ¿€æ´»é˜ˆå€¼ï¼Œå‡½æ•° ``f(â‹…)`` ä¹Ÿè¢«ç§°ä¸ºæ˜¯æ¿€æ´»å‡½æ•°ã€‚

* å¸¸ç”¨çš„æ–¹æ³•æ˜¯ç”¨sigmodå‡½æ•°æ¥è¡¨ç¤ºæ¿€æ´»å‡½æ•°ï¼Œè¡¨è¾¾å¼ä¸º :math:`f(x)=\frac{1}{1+e^{-x}}`

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/AglfkZ.png



æ„ŸçŸ¥æœºå’Œç¥ç»ç½‘ç»œ
================

* æ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰é€šå¸¸è¢«è®¤ä¸ºæ˜¯æœ€æ—©çš„ä¸€ç§äººå·¥ç¥ç»ç½‘ç»œæ¨¡å‹ä¹‹ä¸€ï¼Œå®ƒç”±Frank Rosenblattäº1958å¹´æå‡ºã€‚å°½ç®¡æ„ŸçŸ¥æœºçš„æ¦‚å¿µç›¸å¯¹ç®€å•ï¼Œä½†å®ƒä¸ºåç»­æ›´å¤æ‚çš„ç¥ç»ç½‘ç»œçš„å‘å±•å¥ å®šäº†åŸºç¡€ã€‚
* æ„ŸçŸ¥æœºï¼ˆperceptronï¼‰æ˜¯ç”±ä¸¤å±‚ç¥ç»å…ƒ(è¾“å…¥å±‚å’Œè¾“å‡ºå±‚)ç»„æˆçš„ç»“æ„ï¼Œè¾“å…¥å±‚ç”¨äºæ¥å—å¤–ç•Œè¾“å…¥ä¿¡å·ï¼Œè¾“å‡ºå±‚ï¼ˆä¹Ÿè¢«ç§°ä¸ºæ˜¯æ„ŸçŸ¥æœºçš„åŠŸèƒ½å±‚ï¼‰å°±æ˜¯M-Pç¥ç»å…ƒï¼Œå°†è¿™äº›æ•°æ®é€šè¿‡æƒé‡è¿›è¡Œå¤„ç†åï¼Œè¾“å‡ºä¸€ä¸ªç»“æœã€‚è¾“å‡ºå±‚é€šè¿‡å¯¹è¾“å…¥ä¿¡å·åŠ æƒæ±‚å’Œå¹¶åº”ç”¨ä¸€ä¸ªæ¿€æ´»å‡½æ•°æ¥å†³å®šè¾“å‡ºå€¼ã€‚

.. note:: ä»ç»“æ„ä¸Šæ¥è¯´ï¼Œä¸€ä¸ªæ ‡å‡†çš„æ„ŸçŸ¥æœºæ¨¡å‹å®é™…ä¸ŠåªåŒ…å«ä¸€å±‚â€œæƒé‡â€èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹æ¥æ”¶è¾“å…¥æ•°æ®ï¼Œå¹¶é€šè¿‡åŠ æƒæ±‚å’Œçš„æ–¹å¼è®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œç„¶åé€šè¿‡æ¿€æ´»å‡½æ•°ï¼ˆé€šå¸¸æ˜¯é˜¶è·ƒå‡½æ•°ï¼‰æ¥å†³å®šè¾“å‡ºã€‚å› æ­¤ï¼Œä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œæ„ŸçŸ¥æœºå¯ä»¥è¢«çœ‹ä½œæ˜¯åªæœ‰å•å±‚çš„ç¥ç»ç½‘ç»œï¼Œè€Œä¸æ˜¯ä¸¤å±‚ã€‚ä½†æ˜¯ï¼Œå½“äººä»¬æåˆ°æ„ŸçŸ¥æœºæœ‰â€œä¸¤å±‚ç¥ç»å…ƒâ€çš„æ—¶å€™ï¼Œä»–ä»¬å¯èƒ½æ˜¯æŒ‡åŒ…æ‹¬è¾“å…¥å±‚åœ¨å†…çš„æ•´ä¸ªç»“æ„ã€‚åœ¨è¿™ç§æè¿°ä¸­ï¼šè¾“å…¥å±‚ï¼šä¸è¢«è§†ä¸ºçœŸæ­£çš„ç¥ç»å…ƒå±‚ï¼Œå› ä¸ºè¿™é‡Œçš„èŠ‚ç‚¹åªæ˜¯å°†è¾“å…¥æ•°æ®ä¼ é€’ç»™ä¸‹ä¸€å±‚ï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è®¡ç®—æˆ–å˜æ¢ã€‚è¾“å‡ºå±‚ï¼šè¿™ä¸€å±‚åŒ…å«äº†æ‰§è¡Œå®é™…è®¡ç®—çš„ç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒæ¥æ”¶æ¥è‡ªè¾“å…¥å±‚çš„æ•°æ®ï¼Œå¯¹å…¶è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¹¶é€šè¿‡æ¿€æ´»å‡½æ•°äº§ç”Ÿæœ€ç»ˆè¾“å‡ºã€‚ **è¿™ç§è¡¨è¿°æ–¹å¼æœ‰åŠ©äºä¸å¤šå±‚ç¥ç»ç½‘ç»œï¼ˆå¦‚æ·±åº¦å­¦ä¹ ä¸­çš„æ¨¡å‹ï¼‰è¿›è¡Œå¯¹æ¯”å’Œç†è§£ã€‚** â€”â€”fromGPT



.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/IZUYmc.png

    ä¸€ä¸ªè¾“å…¥å±‚å…·æœ‰ä¸‰ä¸ªç¥ç»å…ƒï¼ˆåˆ†åˆ«è¡¨ç¤ºä¸ºx0ã€x1ã€x2ï¼‰çš„æ„ŸçŸ¥æœºç»“æ„ã€‚ï¼ˆç¥ç»å…ƒçš„ä¸»è¦ç»„æˆéƒ¨åˆ†åŒ…æ‹¬è½´çªï¼ˆaxonï¼‰ã€æ ‘çªï¼ˆdendriteï¼‰ã€èƒä½“ï¼ˆsomaï¼‰å’Œçªè§¦ï¼ˆsynapseï¼‰ï¼‰


* æ„ŸçŸ¥æœºæ¨¡å‹çš„å…¬å¼è¡¨ç¤º: :math:`y=f(w x+b)` å…¶ä¸­ï¼Œwä¸ºæ„ŸçŸ¥æœºè¾“å…¥å±‚åˆ°è¾“å‡ºå±‚è¿æ¥çš„æƒé‡ï¼Œbè¡¨ç¤ºè¾“å‡ºå±‚çš„åç½®ã€‚äº‹å®ä¸Šï¼Œæ„ŸçŸ¥æœºæ˜¯ä¸€ç§åˆ¤åˆ«å¼çš„çº¿æ€§åˆ†ç±»æ¨¡å‹ï¼Œå¯ä»¥è§£å†³ä¸ã€æˆ–ã€éè¿™æ ·çš„ç®€å•çš„çº¿æ€§å¯åˆ†ï¼ˆlinearly separableï¼‰é—®é¢˜


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/aciY7D.png

    çº¿æ€§å¯åˆ†é—®é¢˜çš„ç¤ºæ„å›¾



.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/2P6VlY.png

    å…¸å‹çš„ä¸‰å±‚ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ„æˆï¼ŒLayer L1æ˜¯è¾“å…¥å±‚ï¼ŒLayer L2æ˜¯éšå«å±‚ï¼ŒLayer L3æ˜¯è¾“å‡ºå±‚


Boltzmannæœºå’Œå—é™Boltzmannæœº
----------------------------

* ç¥ç»ç½‘ç»œä¸­æœ‰ä¸€ç±»æ¨¡å‹æ˜¯ä¸ºç½‘ç»œçŠ¶æ€å®šä¹‰ä¸€ä¸ªâ€œèƒ½é‡â€ï¼Œèƒ½é‡æœ€å°åŒ–æ—¶ç½‘ç»œè¾¾åˆ°ç†æƒ³çŠ¶æ€ï¼Œè€Œç½‘ç»œçš„è®­ç»ƒå°±æ˜¯åœ¨æœ€å°åŒ–è¿™ä¸ªèƒ½é‡å‡½æ•°ã€‚Boltzmannï¼ˆç»å°”å…¹æ›¼ï¼‰æœºå°±æ˜¯åŸºäºèƒ½é‡çš„æ¨¡å‹ï¼Œå…¶ç¥ç»å…ƒåˆ†ä¸ºä¸¤å±‚ï¼šæ˜¾å±‚å’Œéšå±‚ã€‚æ˜¾å±‚ç”¨äºè¡¨ç¤ºæ•°æ®çš„è¾“å…¥å’Œè¾“å‡ºï¼Œéšå±‚åˆ™è¢«ç†è§£ä¸ºæ•°æ®çš„å†…åœ¨è¡¨è¾¾ã€‚Boltzmannæœºçš„ç¥ç»å…ƒéƒ½æ˜¯å¸ƒå°”å‹çš„ï¼Œå³åªèƒ½å–0ã€1å€¼ã€‚æ ‡å‡†çš„Boltzmannæœºæ˜¯å…¨è¿æ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å„å±‚å†…çš„ç¥ç»å…ƒéƒ½æ˜¯ç›¸äº’è¿æ¥çš„ï¼Œå› æ­¤è®¡ç®—å¤æ‚åº¦å¾ˆé«˜ï¼Œè€Œä¸”éš¾ä»¥ç”¨æ¥è§£å†³å®é™…é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ä¸€ç§ç‰¹æ®Šçš„Boltzmannæœºâ€”â€”å—é™ç»å°”å…¹æ›¼æœºï¼ˆRestricted Boltzmann Mechineï¼Œç®€ç§°RBMï¼‰ï¼Œå®ƒå±‚å†…æ— è¿æ¥ï¼Œå±‚é—´æœ‰è¿æ¥ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªäºŒéƒ¨å›¾ã€‚

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/aerRnB.png


RBFç½‘ç»œ
-------

* RBFï¼ˆRadial Basis Functionï¼‰å¾„å‘åŸºå‡½æ•°ç½‘ç»œæ˜¯ä¸€ç§å•éšå±‚å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå®ƒä½¿ç”¨å¾„å‘åŸºå‡½æ•°ä½œä¸ºéšå±‚ç¥ç»å…ƒæ¿€æ´»å‡½æ•°ï¼Œè€Œè¾“å‡ºå±‚åˆ™æ˜¯å¯¹éšå±‚ç¥ç»å…ƒè¾“å‡ºçš„çº¿æ€§ç»„åˆã€‚

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/0QY42H.png

è®­ç»ƒRBFç½‘ç»œé€šå¸¸é‡‡ç”¨ä¸¤æ­¥::

    1> ç¡®å®šç¥ç»å…ƒä¸­å¿ƒï¼Œå¸¸ç”¨çš„æ–¹å¼åŒ…æ‹¬éšæœºé‡‡æ ·ï¼Œèšç±»ç­‰ï¼›
    2> ç¡®å®šç¥ç»ç½‘ç»œå‚æ•°ï¼Œå¸¸ç”¨ç®—æ³•ä¸ºBPç®—æ³•ã€‚

ARTç½‘ç»œ
-------

* ARTï¼ˆAdaptive Resonance Theoryï¼‰è‡ªé€‚åº”è°æŒ¯ç†è®ºç½‘ç»œæ˜¯ç«äº‰å‹å­¦ä¹ çš„é‡è¦ä»£è¡¨ï¼Œè¯¥ç½‘ç»œç”±æ¯”è¾ƒå±‚ã€è¯†åˆ«å±‚ã€è¯†åˆ«å±‚é˜ˆå€¼å’Œé‡ç½®æ¨¡å—æ„æˆã€‚ARTæ¯”è¾ƒå¥½çš„ç¼“è§£äº†ç«äº‰å‹å­¦ä¹ ä¸­çš„â€œå¯å¡‘æ€§-ç¨³å®šæ€§çª˜å¢ƒâ€ï¼ˆstability-plasticity dilemmaï¼‰ï¼Œå¯å¡‘æ€§æ˜¯æŒ‡ç¥ç»ç½‘ç»œè¦æœ‰å­¦ä¹ æ–°çŸ¥è¯†çš„èƒ½åŠ›ï¼Œè€Œç¨³å®šæ€§åˆ™æŒ‡çš„æ˜¯ç¥ç»ç½‘ç»œåœ¨å­¦ä¹ æ–°çŸ¥è¯†æ—¶è¦ä¿æŒå¯¹æ—§çŸ¥è¯†çš„è®°å¿†ã€‚è¿™å°±ä½¿å¾—ARTç½‘ç»œå…·æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ä¼˜ç‚¹ï¼šå¯è¿›è¡Œå¢é‡å­¦ä¹ æˆ–åœ¨çº¿å­¦ä¹ ã€‚


SOMç½‘ç»œ
-------

* SOMï¼ˆSelf-Organizing Mapï¼Œè‡ªç»„ç»‡æ˜ å°„ï¼‰ç½‘ç»œæ˜¯ä¸€ç§ç«äº‰å­¦ä¹ å‹çš„æ— ç›‘ç£ç¥ç»ç½‘ç»œï¼Œå®ƒèƒ½å°†é«˜ç»´è¾“å…¥æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ˆé€šå¸¸ä¸ºäºŒç»´ï¼‰ï¼ŒåŒæ—¶ä¿æŒè¾“å…¥æ•°æ®åœ¨é«˜ç»´ç©ºé—´çš„æ‹“æ‰‘ç»“æ„ï¼Œå³å°†é«˜ç»´ç©ºé—´ä¸­ç›¸ä¼¼çš„æ ·æœ¬ç‚¹æ˜ å°„åˆ°ç½‘ç»œè¾“å‡ºå±‚ä¸­çš„ä¸´è¿‘ç¥ç»å…ƒã€‚

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/P6iFWC.png






forward propagation å‰å‘ä¼ æ’­
============================

* FPç®—æ³•
* å‰å‘ä¼ æ’­ï¼ˆforward propagationæˆ–forward passï¼‰ æŒ‡çš„æ˜¯ï¼šæŒ‰é¡ºåºï¼ˆä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚ï¼‰è®¡ç®—å’Œå­˜å‚¨ç¥ç»ç½‘ç»œä¸­æ¯å±‚çš„ç»“æœã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/T1rWVG.png

    ç¬¬ä¸€å±‚æ˜¯è¾“å…¥å±‚ï¼ŒåŒ…å«ä¸¤ä¸ªç¥ç»å…ƒi1ï¼Œi2ï¼Œå’Œåç½®é¡¹ï¼ˆbias termï¼‰b1ï¼›ç¬¬äºŒå±‚æ˜¯éšå«å±‚ï¼ŒåŒ…å«ä¸¤ä¸ªç¥ç»å…ƒh1,h2å’Œåç½®é¡¹ï¼ˆbias termï¼‰b2ï¼Œç¬¬ä¸‰å±‚æ˜¯è¾“å‡ºo1,o2ï¼Œæ¯æ¡çº¿ä¸Šæ ‡çš„wiæ˜¯å±‚ä¸å±‚ä¹‹é—´è¿æ¥çš„æƒé‡ï¼Œæ¿€æ´»å‡½æ•°æˆ‘ä»¬é»˜è®¤ä¸ºsigmoidå‡½æ•°ã€‚

èµ‹ä¸Šåˆå€¼::

    è¾“å…¥æ•°æ®  i1=0.05, i2=0.10
    è¾“å‡ºæ•°æ®  o1=0.01, o2=0.99
    åˆå§‹æƒé‡  w1=0.15, w2=0.20, w3=0.25, w4=0.30
             w5=0.40, w6=0.45, w7=0.50, w8=0.55


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/MBZJqt.png

1.è¾“å…¥å±‚---->éšå«å±‚
-------------------

* è®¡ç®—ç¥ç»å…ƒh1çš„è¾“å…¥åŠ æƒå’Œï¼š

.. math::

    \begin{array}{l}
    \text { net }_{h1}=w_{1} * i_{1}+w_{2} * i_{2}+b_{1} * 1 \\
    \text { net }_{h1}=0.15 * 0.05+0.2 * 0.1+0.35 * 1=0.3775
    \end{array}

* ç¥ç»å…ƒh1çš„è¾“å‡ºo1:(æ­¤å¤„ç”¨åˆ°æ¿€æ´»å‡½æ•°ä¸ºsigmoidå‡½æ•°)ï¼š

.. math::

    {out}_{h1}=\frac{1}{1+e^{-net_{h_1}} } = \frac{1}{1+e^{-0.3775}}=0.593269992

* åŒç†ï¼Œå¯è®¡ç®—å‡ºç¥ç»å…ƒh2çš„è¾“å‡ºo2: :math:`{out}_{h2}=0.596884378`


2.éšå«å±‚---->è¾“å‡ºå±‚
-------------------

* è®¡ç®—è¾“å‡ºå±‚ç¥ç»å…ƒo1å’Œo2çš„å€¼

.. math::

    \begin{array}{l}
    \text {net}_{o1} =w_5*{out}_{h1}+w_6*{out}_{h2}+b_2*1 \\
    \text {net}_{o1} =0.4*0.593269992 + 0.45*0.596884378 + 0.6*1 = 1.105905967 \\
    \text {out}_{o1} =\frac{1}{1+e^{-{net}_{o1}}} = \frac{1}{1+e^{1.105905967}} = 0.75136507 \\
    åŒç† \\
    \text {out}_{o2} = 0.772928465
    \end{array}


.. note:: å‰å‘ä¼ æ’­çš„è¿‡ç¨‹å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬å¾—åˆ°è¾“å‡ºå€¼ä¸º[0.75136079 , 0.772928465]ï¼Œä¸å®é™…å€¼[0.01 , 0.99]ç›¸å·®è¿˜å¾ˆè¿œ



backward propagation åå‘ä¼ æ’­
=============================

* BPç®—æ³•ï¼Œä¹Ÿå« Î´ç®—æ³•
* åå‘ä¼ æ’­ï¼ˆbackward propagationæˆ–backpropagationï¼‰æŒ‡çš„æ˜¯è®¡ç®—ç¥ç»ç½‘ç»œå‚æ•°æ¢¯åº¦çš„æ–¹æ³•ã€‚ ç®€è¨€ä¹‹ï¼Œè¯¥æ–¹æ³•æ ¹æ®å¾®ç§¯åˆ†ä¸­çš„é“¾å¼è§„åˆ™ï¼ŒæŒ‰ç›¸åçš„é¡ºåºä»è¾“å‡ºå±‚åˆ°è¾“å…¥å±‚éå†ç½‘ç»œã€‚ è¯¥ç®—æ³•å­˜å‚¨äº†è®¡ç®—æŸäº›å‚æ•°æ¢¯åº¦æ—¶æ‰€éœ€çš„ä»»ä½•ä¸­é—´å˜é‡ï¼ˆåå¯¼æ•°ï¼‰ã€‚
* åå‘ä¼ æ’­ï¼šâ€œè¯¯å·®åå‘ä¼ æ’­â€çš„ç®€ç§°ï¼Œæ˜¯ä¸€ç§ä¸æœ€ä¼˜åŒ–æ–¹æ³•ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™æ³•ï¼‰ç»“åˆä½¿ç”¨çš„ï¼Œç”¨æ¥è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œçš„å¸¸è§æ–¹æ³•ã€‚ è¯¥æ–¹æ³•å¯¹ç½‘ç»œä¸­æ‰€æœ‰æƒé‡è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€‚ è¿™ä¸ªæ¢¯åº¦ä¼šåé¦ˆç»™æœ€ä¼˜åŒ–æ–¹æ³•ï¼Œç”¨æ¥æ›´æ–°æƒå€¼ä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚



1.è®¡ç®—æ€»è¯¯å·®
------------

* è¯¯å·®ï¼š(square error): :math:`E_{total} = \sum{\frac{1}{2}(target-output)^2}`
* æœ‰ä¸¤ä¸ªè¾“å‡ºï¼Œæ‰€ä»¥åˆ†åˆ«è®¡ç®—o1å’Œo2çš„è¯¯å·®ï¼Œæ€»è¯¯å·®ä¸ºä¸¤è€…ä¹‹å’Œ

.. math::

    \begin{array}{l}
    \text E_{o1}=\frac{1}{2}(target_{o1} - out_{o1})^2 = \frac{1}{2}(0.01-0.75136507)^2 = 0.274811083 \\
    \text E_{o2} = 0.023560026 \\
    \text E_{total} = E_{o1} + E_{o2} = 0.274811083 + 0.023560026 = 0.298371109
    \end{array}

2.éšå«å±‚---->è¾“å‡ºå±‚(w5-w8)çš„æƒå€¼æ›´æ–°
------------------------------------

* ä»¥æƒé‡å‚æ•°w5ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“w5å¯¹æ•´ä½“è¯¯å·®äº§ç”Ÿäº†å¤šå°‘å½±å“ï¼Œå¯ä»¥ç”¨æ•´ä½“è¯¯å·®å¯¹w5æ±‚åå¯¼æ±‚å‡º(é“¾å¼æ³•åˆ™)

.. math::

    \frac{\partial E_{\text {total }}}{\partial w_{5}}=\frac{\partial E_{\text {total}}}{\partial out_{o1}} *
        \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}}

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/W0l3WL.png

    è¯¯å·®æ˜¯æ€æ ·åå‘ä¼ æ’­çš„

* è®¡ç®— :math:`\frac{\partial E_{total}}{\partial out_{o1}}`

.. math::

    \begin{array}{l}
    \text E_{total} = \frac{1}{2}(target_{o1} - out_{o1})^2 + \frac{1}{2}(target_{o2} - out_{o2})^2 \\
    \frac{\partial E_{total}}{\partial out_{o1}} = out_{o1} - target_{o1}
        = 0.75136507 - 0.01 = 0.74136507
    \end{array}


* è®¡ç®— :math:`\frac{\partial out_{o1}}{\partial net_{o1}}` :

.. math::

    \begin{array}{l}
    out_{o1} = \frac{1}{1+e^{-net_{o1}}} \\
    \frac{\partial out_{o1}}{\partial net_{o1}} = out_{o1}(1-out_{o1})
        = 0.75136507(1-0.75136507) = 0.186815602
    \end{array}

    æ³¨ï¼šè¿™å„¿çš„æ¨å¯¼è¿‡ç¨‹åé¢ä¸“é—¨è®²ä¸€ä¸‹


* è®¡ç®— :math:`\frac{\partial net_{o1}}{\partial w_5}`

.. math::

    net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1
    \frac{\partial net_{o1}}{\partial w_5} = out_{h1} = 0.593269992


æœ€åä¸‰è€…ç›¸ä¹˜(è®¡ç®—å‡ºæ•´ä½“è¯¯å·®E(total)å¯¹w5çš„åå¯¼å€¼):

.. math::

    \begin{array}{l}
    \frac{\partial E_{total}}{\partial w_{5}}=\frac{\partial E_{\text {total }}}{\partial out_{o1}} *
        \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}} \\
        = 0.74136507 * 0.186815602 * 0.593269992 \\
        = 0.082167041
    \end{array}


ä¸Šé¢3ä¸ªå…¬å¼åˆå¹¶:

.. math::

    \frac{\partial E_{total}}{\partial w_{5}}=
        (out_{o2} - target_{o2}) * out_{o1}(1-out_{o1}) * out_{h1}


* ä¸ºäº†è¡¨è¾¾æ–¹ä¾¿ï¼Œç”¨ :math:`\delta_{o1}` æ¥è¡¨ç¤ºè¾“å‡ºå±‚çš„è¯¯å·®

.. math::

    \begin{array}{l}
    \delta_{o1}=\frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}}=\frac{\partial E_{total}}{\partial net_{o1}} \\
    \delta_{o1}=-(target_{o1} - out_{o1}) * out_{o1}(1-out_{o1})
               =-(0.01-0.75136507) * 0.75136507 * (1-0.75136507)
               =0.74136507*0.18681560 = 0.138498562
    \end{array}


å› æ­¤ï¼Œæ•´ä½“è¯¯å·®E(total)å¯¹w5çš„åå¯¼å…¬å¼å¯ä»¥å†™æˆï¼š

.. math::

    \frac{\partial E_{\text {total }}}{\partial w_{5}}= |\delta_{o1}out_{h1}|


* æ›´æ–°w5çš„å€¼(è¿™å„¿ :math:`\eta` æ˜¯å­¦ä¹ ç‡ï¼Œè¿™å„¿å–0.5) :math:`{w_5}^+=w_5-\eta * \frac{\partial E_{total}}{\partial w_5} = 0.4 - 0.5*0.082167041=0.35891648`
* åŒç†ï¼Œå¯æ›´æ–°w6,w7,w8:

.. math::

    \begin{array}{l}
    {w_6}^+ = 0.408666186 \\
    {w_7}^+ = 0.511301270 \\
    {w_8}^+ = 0.561370121 \\
    \end{array}


3.è¾“å…¥å±‚--->éšå«å±‚çš„æƒå€¼(w1-w4)æ›´æ–°
-----------------------------------


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/wXtyDk.png

    ä¸ä¸Šé¢è¯´çš„å·®ä¸å¤šï¼Œä½†æ˜¯æœ‰ä¸ªåœ°æ–¹éœ€è¦å˜ä¸€ä¸‹ï¼Œåœ¨ä¸Šæ–‡è®¡ç®—æ€»è¯¯å·®å¯¹w5çš„åå¯¼æ—¶ï¼Œæ˜¯ä»out(o1)--->net(o1)--->w5,ä½†æ˜¯åœ¨éšå«å±‚ä¹‹é—´çš„æƒå€¼æ›´æ–°æ—¶ï¼Œæ˜¯out(h1)--->net(h1)--->w1,è€Œout(h1)ä¼šæ¥å—E(o1)å’ŒE(o2)ä¸¤ä¸ªåœ°æ–¹ä¼ æ¥çš„è¯¯å·®ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹ä¸¤ä¸ªéƒ½è¦è®¡ç®—ã€‚

è®¡ç®— :math:`\frac{\partial E_{total}}{\partial out_{h1}}`:

.. math::

    \frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}}


* å…ˆè®¡ç®— :math:`\frac{\partial E_{o1}}{\partial out_{h1}}`

.. math::

    \begin{array}{l}
    \frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} \cdot \frac{\partial net_{o1}}{\partial out_{h1}} \\
    \frac{\partial E_{o1}}{\partial net_{o1}} = \frac{\partial E_{o1}}{\partial out_{o1}} \cdot \frac{\partial out_{o1}}{\partial net_{o1}} \\
        = 0.74136507 \cdot 0.186815602 = 0.138498562 \\
    net_{o1} = w_5 \cdot out_{h1} + w_6 \cdot out_{h2} + b_2 \cdot 1 \\
    \frac{\partial net_{o1}}{\partial out_{h1}} = w_5 = 0.40 \\
    \frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} \cdot \frac{\partial net_{o1}}{\partial out_{h1}} \\
        = 0.138498562 \cdot 0.40 = 0.055399425 \\
    åŒç† \\
    \frac{\partial E_{o2}}{\partial out_{h1}} = -0.019049119 \\
    ä¸¤è€…ç›¸åŠ  \\
    \frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}} \\
        = 0.055399425 + (-0.019049119) = 0.036350306
    \end{array}


å†è®¡ç®— :math:`\frac{\partial out_{h1}}{\partial net_{h1}}` :

.. math::

    \begin{array}{l}
    out_{h1} = \frac{1}{1+e^{-net_{h1}}} \\
    \frac{\partial out_{h1}}{\partial net_{h1}} = out_{h1}(1-out_{h1}) \\
        = 0.59326999(1-0.59326999) = 0.241300709
    \end{array}

å†è®¡ç®— :math:`\frac{\partial net_{h1}}{\partial w1}` :

.. math::

    \begin{array}{l}
    net_{h1} = w_1*i_1 + w_2*i_2 + b_1 *1 \\
    \frac{\partial net_{h1}}{\partial w_1} = i_1=0.05
    \end{array}

ä¸‰è€…ç›¸ä¹˜


.. math::

    \begin{array}{l}
    \frac{\partial E_{total}}{\partial w_{1}}=\frac{\partial E_{total}}{\partial out_{h1}} *
        \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net{h1}}{\partial w_{1}} \\
        = 0.036350306 * 0.241300709 * 0.05
        = 0.000438568
    \end{array}

* ä¸Šé¢çš„è¿‡ç¨‹æ±‡æ€»

.. math::

    \frac{\partial E_{total}}{\partial w_1} = 
        (\sum_o \frac{\partial E_{total}}{\partial out_o} * \frac{\partial out_o}{\partial net_o} * \frac{\partial net_o}{\partial out_{h1}}) 
            * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_1} \\



.. * ä¸ºäº†è¡¨è¾¾æ–¹ä¾¿ï¼Œç”¨ :math:`\sigma_{h1}` æ¥è¡¨ç¤ºéšå«å±‚å•å…ƒh1çš„è¯¯å·®

.. .. math::

..     \begin{array}{l}
..     \frac{\partial E_{total}}{\partial w_1} = (\sum_o \frac{\partial E_{total}}{\partial out_o} * \frac{\partial out_o}{\partial net_o} * \frac{\partial net_o}{\partial out_{h1}}) * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_1} \\
..         = (\sum_o {\sigma_o * w_{ho}}) * out_{h1} * (1- out_{h1}) * i_1
..         = \sigma_{h1} i_1
..     \end{array}


* æœ€åï¼Œæ›´æ–°w1çš„æƒå€¼ï¼š(è¿™å„¿ :math:`\eta` æ˜¯å­¦ä¹ ç‡ï¼Œè¿™å„¿å–0.5) :math:`{w_1}^+=w_1-\eta * \frac{\partial E_{total}}{\partial w_1} = 0.15 - 0.5*0.000438568=0.149780716`
* åŒç†ï¼Œå¯æ›´æ–°w1,w2,w3:

.. math::

    \begin{array}{l}
    {w_2}^+ = 0.19956143 \\
    {w_3}^+ = 0.24975114 \\
    {w_4}^+ = 0.29950229 \\
    \end{array}

.. note:: è¿™æ ·è¯¯å·®åå‘ä¼ æ’­æ³•å°±å®Œæˆäº†ï¼Œæœ€åæˆ‘ä»¬å†æŠŠæ›´æ–°çš„æƒå€¼é‡æ–°è®¡ç®—ï¼Œä¸åœåœ°è¿­ä»£ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ç¬¬ä¸€æ¬¡è¿­ä»£ä¹‹åï¼Œæ€»è¯¯å·®E(total)ç”±0.298371109ä¸‹é™è‡³0.291027924ã€‚è¿­ä»£10000æ¬¡åï¼Œæ€»è¯¯å·®ä¸º0.000035085ï¼Œè¾“å‡ºä¸º[0.015912196,0.984065734](åŸè¾“å…¥ä¸º[0.01,0.99]),è¯æ˜æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚


:math:`\frac{1}{1+e^{-n}}` æ±‚å¯¼å…¬å¼æ¨ç†
=======================================

* :math:`ğ‘“(ğ‘›)=\frac{1}{1+e^{-n}}` æ±‚å¯¼å…¬å¼æ¨ç†
* 1ã€é‡å†™ä¸º :math:`ğ‘“(ğ‘›)=(1+e^{-n})^{-1}`
* 2ã€æ±‚å¯¼: :math:`ğ‘“â€²(ğ‘›)=-\frac{1}{(1+e^{-n})^2} \cdot \frac{d}{dn}(1+e^{-n})`
* 3ã€è®¡ç®—å†…éƒ¨çš„å¯¼æ•°: :math:`\frac{d}{dn}(1+e^{-n}) = -e^{-n}`
* 4ã€ä»£å…¥ç¬¬2æ­¥: :math:`ğ‘“â€²(ğ‘›)=-\frac{1}{(1+e^{-n})^2} \cdot (-e^{-n})=\frac{e^{-n}}{(1+e^{-n})^2}`
* 5ã€ç”±äº :math:`ğ‘“(ğ‘›)=\frac{1}{1+e^{-n}}` å°†åˆ†å­å’Œåˆ†æ¯è¡¨ç¤ºæˆ ğ‘“(ğ‘›) çš„å½¢å¼ :math:`ğ‘“â€²(ğ‘›)=ğ‘“(ğ‘›) \cdot (1-ğ‘“(ğ‘›))`






æ¼”ç¤ºDemo
========

.. literalinclude:: ./files/propagation.py
    :language: python



å›¾ç¤ºä¾‹åå‘ä¼ æ’­
==============

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/h2REcu.png
    :width: 50 %

    åå‘ä¼ æ’­ç®—æ³•çš„å¤šå±‚ç¥ç»ç½‘ç»œçš„æ•™å­¦è¿‡ç¨‹ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ å¤„ç†å¦‚å›¾æ‰€ç¤ºçš„å…·æœ‰ä¸¤ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºçš„ä¸‰å±‚ç¥ç»ç½‘ç»œ


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/ElshJt.png
    :width: 50 %

    æ¯ä¸ªç¥ç»å…ƒç”±ä¸¤ä¸ªå•å…ƒç»„æˆã€‚ç¬¬ä¸€ä¸ªå•å…ƒå°†æƒé‡ç³»æ•°å’Œè¾“å…¥ä¿¡å·çš„ä¹˜ç§¯ç›¸åŠ ã€‚ç¬¬äºŒä¸ªå•å…ƒå®ç°éçº¿æ€§å‡½æ•°ï¼Œç§°ä¸ºç¥ç»å…ƒæ¿€æ´»å‡½æ•°ã€‚ä¿¡å·eä¸ºåŠ æ³•å™¨è¾“å‡ºä¿¡å·ï¼Œ y=f(e)ä¸ºéçº¿æ€§å…ƒä»¶çš„è¾“å‡ºä¿¡å·ã€‚ä¿¡å·yä¹Ÿæ˜¯ç¥ç»å…ƒçš„è¾“å‡ºä¿¡å·ã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/FDeqmU.png
    :width: 50 %

    ç½‘ç»œè®­ç»ƒæ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œä½¿ç”¨è®­ç»ƒæ•°æ®é›†ä¸­çš„æ–°æ•°æ®æ¥ä¿®æ”¹èŠ‚ç‚¹çš„æƒé‡ç³»æ•°ã€‚ä½¿ç”¨ä¸‹è¿°ç®—æ³•è®¡ç®—ä¿®æ”¹ï¼šæ¯ä¸ªè®­ç»ƒæ­¥éª¤éƒ½å¼ºåˆ¶ä»è®­ç»ƒé›†çš„ä¸¤ä¸ªè¾“å…¥ä¿¡å·å¼€å§‹ã€‚åœ¨æ­¤é˜¶æ®µä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæ¯ä¸ªç½‘ç»œå±‚ä¸­æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºä¿¡å·å€¼ã€‚ä¸‹å›¾è¯´æ˜äº†ä¿¡å·å¦‚ä½•åœ¨ç½‘ç»œä¸­ä¼ æ’­ï¼Œç¬¦å· :math:`w_{(x_m)n}` è¡¨ç¤ºç½‘ç»œè¾“å…¥ :math:`x_m` ä¸è¾“å…¥å±‚ç¥ç»å…ƒnä¹‹é—´çš„è¿æ¥æƒé‡ã€‚ç¬¦å· :math:`y_n` è¡¨ç¤ºç¥ç»å…ƒnçš„è¾“å‡ºä¿¡å·ã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/5y4XIN.png
    :width: 50 %

    é€šè¿‡éšè—å±‚ä¼ æ’­ä¿¡å·ã€‚ç¬¦å· :math:`w_{mn}` è¡¨ç¤ºç¥ç»å…ƒmçš„è¾“å‡ºä¸ä¸‹ä¸€å±‚ç¥ç»å…ƒnçš„è¾“å…¥ä¹‹é—´çš„è¿æ¥æƒé‡ã€‚

.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/EK0qBc.png
    :width: 50 %

    é€šè¿‡è¾“å‡ºå±‚ä¼ æ’­ä¿¡å·ã€‚Propagation of signals through the output layer.



.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/aoeQyp.png
    :width: 50 %

    åœ¨ä¸‹ä¸€ä¸ªç®—æ³•æ­¥éª¤ä¸­ï¼Œå°†ç½‘ç»œyçš„è¾“å‡ºä¿¡å·ä¸è®­ç»ƒæ•°æ®é›†çš„ç›®æ ‡å€¼(label)è¿›è¡Œæ¯”è¾ƒã€‚è¯¥å·®å€¼ç§°ä¸ºè¾“å‡ºå±‚ç¥ç»å…ƒçš„è¯¯å·®ä¿¡å·d ã€‚



.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/NlT2pm.png
    :width: 50 %

    ç›´æ¥è®¡ç®—å†…éƒ¨ç¥ç»å…ƒçš„è¯¯å·®ä¿¡å·æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºè¿™äº›ç¥ç»å…ƒçš„è¾“å‡ºå€¼æ˜¯æœªçŸ¥çš„ã€‚å¤šå¹´æ¥ï¼Œè®­ç»ƒå¤šç»“ç‚¹ç½‘ç»œçš„æœ‰æ•ˆæ–¹æ³•ä¸€ç›´æœªçŸ¥ã€‚ç›´åˆ°å…«åå¹´ä»£ä¸­æœŸï¼Œåå‘ä¼ æ’­ç®—æ³•æ‰è¢«ç ”ç©¶å‡ºæ¥ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯å°†è¯¯å·®ä¿¡å·d ï¼ˆåœ¨å•ä¸ªæ•™å­¦æ­¥éª¤ä¸­è®¡ç®—ï¼‰ä¼ æ’­å›æ‰€æœ‰ç¥ç»å…ƒï¼Œå…¶è¾“å‡ºä¿¡å·æ˜¯æ‰€è®¨è®ºç¥ç»å…ƒçš„è¾“å…¥ã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/4dO6ai.png
    :width: 50 %

    ç”¨äºä¼ æ’­è¯¯å·®çš„æƒé‡ç³»æ•° :math:`w_{mn}` ç­‰äºè®¡ç®—è¾“å‡ºå€¼æœŸé—´ä½¿ç”¨çš„æƒé‡ç³»æ•°ã€‚ä»…æ”¹å˜æ•°æ®æµçš„æ–¹å‘ï¼ˆä¿¡å·ä»è¾“å‡ºä¾æ¬¡ä¼ æ’­åˆ°è¾“å…¥ï¼‰ã€‚è¯¥æŠ€æœ¯ç”¨äºæ‰€æœ‰ç½‘ç»œå±‚ã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/e2BuKP.png
    :width: 50 %

    å½“è®¡ç®—æ¯ä¸ªç¥ç»å…ƒçš„è¯¯å·®ä¿¡å·æ—¶ï¼Œå¯ä»¥ä¿®æ”¹æ¯ä¸ªç¥ç»å…ƒè¾“å…¥èŠ‚ç‚¹çš„æƒé‡ç³»æ•°ã€‚åœ¨å¦‚å›¾å…¬å¼ä¸­ï¼Œ ``df(e)/de`` è¡¨ç¤ºç¥ç»å…ƒæ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆå…¶æƒé‡è¢«ä¿®æ”¹ï¼‰ã€‚


.. figure:: https://img.zhaoweiguo.com/uPic/2024/11/IPOXKQ.png
    :width: 50 %










å‚è€ƒ
====


* Principles of training multi-layer neural network using backpropagation: http://galaxy.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html
* [Deep Learning] ç¥ç»ç½‘ç»œåŸºç¡€: https://www.cnblogs.com/maybe2030/p/5597716.html


















