uvå‘½ä»¤
######

* GitHub: https://github.com/astral-sh/uv
* æ–‡æ¡£: https://docs.astral.sh/uv/


.. note:: ğŸš€ A single tool to replace pip, pip-tools, pipx, poetry, pyenv, virtualenv, and more.


* An extremely fast Python package and project manager, written in Rust.


å¸¸ç”¨æ“ä½œ
========

uv æ›¿æ¢ pipï¼ˆPython åŒ…ç®¡ç†ï¼‰::

    uv pip install requests
    uv pip install -r requirements.txt
    uv pip uninstall requests


uv æ›¿æ¢ pip-toolsï¼ˆä¾èµ–é”å®š & è§£æï¼‰::

    # è§£æ pyproject.toml å¹¶ç”Ÿæˆ requirements.txt
    uv pip compile pyproject.toml --output-file requirements.txt

uv æ›¿æ¢ pipxï¼ˆå®‰è£…å…¨å±€ CLI å·¥å…·ï¼‰::

    # å…¨å±€å®‰è£… CLI å·¥å…·
    uv venv install httpx
    # è¿è¡Œ blackï¼ˆæ— éœ€å…¨å±€å®‰è£…ï¼‰
    uv venv run black --version

uv æ›¿æ¢ poetryï¼ˆé¡¹ç›®ä¾èµ–ç®¡ç†ï¼‰::

    # åˆå§‹åŒ–é¡¹ç›®(ç”Ÿæˆæ–°é¡¹ç›®ï¼Œé‡Œé¢æœ‰æ–‡ä»¶pyproject.toml)
    uv init <proj>
    # è¯»å– pyproject.toml æ–‡ä»¶ä¸­çš„ [tool.uv.dependencies] éƒ¨åˆ†ï¼Œè‡ªåŠ¨å®‰è£…åˆ—å‡ºçš„ä¾èµ–åº“
    uv pip install
    # ä¾èµ–æ·»åŠ åˆ°ä½ çš„ pyproject.toml æ–‡ä»¶ä¸­å¹¶å®‰è£…
    uv add uvicorn
    # å®‰è£…é¡¹ç›®ä¾èµ–(åŸºäºuv.lock)ï¼Œå¦‚æœæ²¡æœ‰.venvä¼šåˆ›å»º
    uv sync
    uv sync --index-url https://mirrors.aliyun.com/pypi/simple/


uv æ›¿æ¢ virtualenvï¼ˆè™šæ‹Ÿç¯å¢ƒç®¡ç†ï¼‰::

    # åˆ›å»ºä¸€ä¸ªæ–°çš„ Python è™šæ‹Ÿç¯å¢ƒï¼ˆç±»ä¼¼ python -m venvï¼‰
    # è¯´æ˜ï¼šä¸æŒ‡å®š<path>æ—¶ï¼Œ<path>=.venv
    uv venv <path>



.. warning:: âš ï¸ uv ä¸èƒ½ç›´æ¥æ›¿ä»£ pyenvï¼Œä½†å¯ä»¥é…åˆ pyenv ä½¿ç”¨ã€‚


Project management
==================

* uv manages project dependencies and environments, with support for lockfiles, workspaces, and more, similar to ``rye`` or ``poetry``::

    $ uv init example
    Initialized project `example` at `/home/user/example`

    $ cd example

    $ uv add ruff
    Creating virtual environment at: .venv
    Resolved 2 packages in 170ms
       Built example @ file:///home/user/example
    Prepared 2 packages in 627ms
    Installed 2 packages in 1ms
     + example==0.1.0 (from file:///home/user/example)
     + ruff==0.5.4

    $ uv run ruff check
    All checks passed!



Tool management
===============

* uv executes and installs command-line tools provided by Python packages, similar to ``pipx``.
* Run a tool in an ephemeral environment using uvx (an alias for uv tool run)::

    $ uvx pycowsay 'hello world!'
    Resolved 1 package in 167ms
    Installed 1 package in 9ms
     + pycowsay==0.0.0.2
      """

      ------------
    < hello world! >
      ------------
       \   ^__^
        \  (oo)\_______
           (__)\       )\/\
               ||----w |
               ||     ||


Install a tool with uv tool install::

    $ uv tool install ruff
    Resolved 1 package in 6ms
    Installed 1 package in 2ms
     + ruff==0.5.4
    Installed 1 executable: ruff

    $ ruff --version
    ruff 0.5.4



Python management
=================

* uv installs Python and allows quickly switching between versions.
* Install multiple Python versions::

    $ uv python install 3.10 3.11 3.12
    Searching for Python versions matching: Python 3.10
    Searching for Python versions matching: Python 3.11
    Searching for Python versions matching: Python 3.12
    Installed 3 versions in 3.42s
     + cpython-3.10.14-macos-aarch64-none
     + cpython-3.11.9-macos-aarch64-none
     + cpython-3.12.4-macos-aarch64-none


Download Python versions as needed::

    $ uv venv --python 3.12.0
    Using Python 3.12.0
    Creating virtual environment at: .venv
    Activate with: source .venv/bin/activate

    $ uv run --python pypy@3.8 -- python --version
    Python 3.8.16 (a9dbdca6fc3286b0addd2240f11d97d8e8de187a, Dec 29 2022, 11:45:30)
    [PyPy 7.3.11 with GCC Apple LLVM 13.1.6 (clang-1316.0.21.2.5)] on darwin
    Type "help", "copyright", "credits" or "license" for more information.
    >>>>

Use a specific Python version in the current directory::

    $ uv python pin pypy@3.11
    Pinned `.python-version` to `pypy@3.11`


Script support
==============

* uv manages dependencies and environments for single-file scripts.
* Create a new script and add inline metadata declaring its dependencies::

    $ echo 'import requests; print(requests.get("https://astral.sh"))' > example.py

    $ uv add --script example.py requests
    Updated `example.py`

    $ cat example.py
    # /// script
    # requires-python = ">=3.12"
    # dependencies = [
    #     "requests",
    # ]
    # ///
    import requests; print(requests.get("https://astral.sh"))

Then, run the script in an isolated virtual environment::

    $ uv run example.py
    Reading inline script metadata from: example.py
    Installed 5 packages in 12ms
    <Response [200]>


A pip-compatible interface
==========================

* uv provides a drop-in replacement for common pip, pip-tools, and virtualenv commands.

Compile requirements into a platform-independent requirements file::

    $ uv pip compile docs/requirements.in \
       --universal \
       --output-file docs/requirements.txt
    Resolved 43 packages in 12ms


Create a virtual environment::

    $ uv venv
    Using Python 3.12.3
    Creating virtual environment at: .venv
    Activate with: source .venv/bin/activate


Install the locked requirements::

    $ uv pip sync docs/requirements.txt
    Resolved 43 packages in 11ms
    Installed 43 packages in 208ms
     + babel==2.15.0
     + black==24.4.2
     + certifi==2024.7.4
     ...





âš ï¸ æ³¨æ„äº‹é¡¹
===========

* `uv.lock` æ˜¯ä¸º `uv` + `pyproject.toml` æ¶æ„è®¾è®¡çš„ï¼Œä¸å« channel æˆ–å¹³å°ä¿¡æ¯ï¼Œä¸é€‚åˆç›´æ¥æ˜ å°„åˆ° `conda`ã€‚
* `conda` å’Œ `uv/pip` çš„ä¾èµ–è§£ææ–¹å¼ä¸åŒï¼Œå­˜åœ¨ä¸å…¼å®¹é£é™©ï¼Œæ¨èç”¨ `uv` æ¥ç®¡ç† Python åŒ…æ—¶ï¼Œä¸è¦åœ¨åŒä¸€ç¯å¢ƒé‡Œæ··è£… Conda åŒ…ã€‚
* å¦‚æœä½ éœ€è¦ç”Ÿæˆ `.conda-lock` æ–‡ä»¶ï¼ˆæ”¯æŒè·¨å¹³å°æ„å»ºï¼‰ï¼Œè¯·å‚è€ƒ [conda-lock](https://github.com/conda/conda-lock) å·¥å…·ï¼Œè€Œä¸æ˜¯ `uv.lock`ã€‚

::

+---------------------------------------------+---------------------------------------+--------+
| ç›®çš„                                        | æ–¹æ³•                                  | æ¨èåº¦ |
+=============================================+=======================================+========+
| æƒ³ç”¨ `conda` åˆ›å»ºç¯å¢ƒ                       | å¯¼å‡º `requirements.txt` å†ç”¨ `conda`  | â­â­â­    |
+---------------------------------------------+---------------------------------------+--------+
| å·²æœ‰ `conda` ç¯å¢ƒ                           | åœ¨å…¶ä¸­ç”¨ `uv` å®‰è£… `uv.lock` ä¸­çš„ä¾èµ– | â­â­â­â­   |
+---------------------------------------------+---------------------------------------+--------+
| ç”¨ `conda` ç®¡ç³»ç»Ÿä¾èµ–ï¼Œç”¨ `uv` ç®¡ Python åŒ… | åˆ†å±‚ç®¡ç†ï¼Œæœ€ç°ä»£åšæ³•                  | â­â­â­â­â­  |
+---------------------------------------------+---------------------------------------+--------+
































